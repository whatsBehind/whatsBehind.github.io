<!DOCTYPE html>
<html lang="en-us" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="
  What&rsquo;s CORS
  #

CORS is a mechanism to stop you from accessing resource in one origin from another origin. For example, there is an image img.jpg from origin images.com, if you don&rsquo;t have CORS set properly, you can&rsquo;t access the img.jpg from other origins like yourOrigin.com.

  Why needs CORS
  #

CORS is mainly for security usage. Image that your browser stores credential cookies of domain bank.com which is the website of you bank account, and a hacking website hacking.com want to access your bank information and make a transaction from your bank. If without CORS, the javascript script from hacking.com is able to get the cookies under domain bank.com and make requests to bank.com.
CORS can protect your website from malicious requests">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="https://whatsBehind.github.io/docs/programming/web/glossary/cors/">
  <meta property="og:site_name" content="What&#39;s Behind">
  <meta property="og:title" content="CORS">
  <meta property="og:description" content="What’s CORS # CORS is a mechanism to stop you from accessing resource in one origin from another origin. For example, there is an image img.jpg from origin images.com, if you don’t have CORS set properly, you can’t access the img.jpg from other origins like yourOrigin.com.
Why needs CORS # CORS is mainly for security usage. Image that your browser stores credential cookies of domain bank.com which is the website of you bank account, and a hacking website hacking.com want to access your bank information and make a transaction from your bank. If without CORS, the javascript script from hacking.com is able to get the cookies under domain bank.com and make requests to bank.com. CORS can protect your website from malicious requests">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="docs">
    <meta property="article:published_time" content="2023-10-30T08:44:30-07:00">
    <meta property="article:modified_time" content="2023-10-30T08:44:30-07:00">
<title>CORS | What&#39;s Behind</title>
<link rel="icon" href="/favicon.png" >
<link rel="manifest" href="/manifest.json">
<link rel="canonical" href="https://whatsBehind.github.io/docs/programming/web/glossary/cors/">
<link rel="stylesheet" href="/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css" integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin="anonymous">
  <script defer src="/fuse.min.js"></script>
  <script defer src="/en.search.min.f11a862b51385cc137fde2157aa4d6da8d6600ebd7a5d1905cff9f8bcf369b86.js" integrity="sha256-8RqGK1E4XME3/eIVeqTW2o1mAOvXpdGQXP&#43;fi882m4Y=" crossorigin="anonymous"></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><span>What&#39;s Behind</span>
  </a>
</h2>


<div class="book-search hidden">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>















  
  <ul>
    
      
        <li>
          
  
  

  
    <span>Programming</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-a3774d0b7f222c1fd859911bed9f84c7" class="toggle"  />
    <label for="section-a3774d0b7f222c1fd859911bed9f84c7" class="flex justify-between">
      <a role="button" class="">Backend</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-d89b2e5681262822056a3eec9d0a41e4" class="toggle"  />
    <label for="section-d89b2e5681262822056a3eec9d0a41e4" class="flex justify-between">
      <a role="button" class="">Java</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-ac19ec90cf736954489e2a5e8571a790" class="toggle"  />
    <label for="section-ac19ec90cf736954489e2a5e8571a790" class="flex justify-between">
      <a role="button" class="">Nio</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/nio/byte-buffer/" class="">Byte Buffer</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/nio/blocking-mode/" class="">Blocking Mode</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/nio/unblocking-mode/" class="">Unblocking Mode</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/nio/selector/" class="">Selector</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/nio/selector-read/" class="">Selector Read</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/nio/io-model-summary/" class="">I/O  Model Summary</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/nio/multiple-threads/" class="">Multiple Threads</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-3a8a021e398721afe1d6aaefc5a53581" class="toggle"  />
    <label for="section-3a8a021e398721afe1d6aaefc5a53581" class="flex justify-between">
      <a role="button" class="">Net</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/net/tcp-socket/" class="">Tcp Socket</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-30dab7aa6f04e2575ba9575d3f7aa552" class="toggle"  />
    <label for="section-30dab7aa6f04e2575ba9575d3f7aa552" class="flex justify-between">
      <a role="button" class="">Io</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/io/decorator-pattern-in-java-io/" class="">Decorator Pattern in Java IO</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/io/object-input-and-output-stream/" class="">ObjectInputStream and ObjectOutputStream</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/io/stream-reader-bridge-of-byte-and-char/" class="">Stream Reader: Bridge of Byte and Char</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/io/io-stream/" class="">Java IO Stream</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/io/file/" class="">Java File</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-12abf7232ea9d442045b1411b7978a30" class="toggle"  />
    <label for="section-12abf7232ea9d442045b1411b7978a30" class="flex justify-between">
      <a role="button" class="">Thread</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/thread/start-thread/" class="">Start Thread</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/thread/common-methods/" class="">Common Methods</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/thread/thread-lifecycle/" class="">Thread Lifecycle</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/thread/synchornization/" class="">Synchronization</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/thread/thread-safety/" class="">Thread Safety</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/reflection/" class="">Reflection</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-de3ec6a026b81e65f77c5a7c0f2cd777" class="toggle"  />
    <label for="section-de3ec6a026b81e65f77c5a7c0f2cd777" class="flex justify-between">
      <a role="button" class="">Netty</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/netty/event-loop-group/" class="">EventLoop &amp; EventLoopGroup</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/netty/channel/" class="">Channel &amp; ChannelFuture</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/netty/pipeline-handler/" class="">Pipeline &amp; Handler</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-7fca83de470936b8f46c9d214eb96e6f" class="toggle"  />
    <label for="section-7fca83de470936b8f46c9d214eb96e6f" class="flex justify-between">
      <a role="button" class="">API</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/api/restful-get/" class="">RESTful GET</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-3267b427ef0b7fb8be17928f82652d59" class="toggle"  />
    <label for="section-3267b427ef0b7fb8be17928f82652d59" class="flex justify-between">
      <a role="button" class="">Python</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/python/executing-a-python-file/" class="">How Is Python File Executed</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/python/re/" class="">RegEx</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/python/format-string/" class="">format-string</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-9488811b2da44d814b719a324549338f" class="toggle"  />
    <label for="section-9488811b2da44d814b719a324549338f" class="flex justify-between">
      <a role="button" class="">Project</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/project/online-chat/" class="">Online Chat</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/project/node-js-auth/" class="">Node Js Auth</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-15e5b6cfbe135e4220353ad911edbc9a" class="toggle"  />
    <label for="section-15e5b6cfbe135e4220353ad911edbc9a" class="flex justify-between">
      <a role="button" class="">Os</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-128d8751d4236191f55b9181cd918421" class="toggle"  />
    <label for="section-128d8751d4236191f55b9181cd918421" class="flex justify-between">
      <a role="button" class="">Linux</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/os/linux/linux-manual/" class="">Linux Manual</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-a437cea16383409ff4bb050630be8e13" class="toggle"  />
    <label for="section-a437cea16383409ff4bb050630be8e13" class="flex justify-between">
      <a role="button" class="">MAC Os</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-61556e42b41c13f33940b404f66932ed" class="toggle"  />
    <label for="section-61556e42b41c13f33940b404f66932ed" class="flex justify-between">
      <a role="button" class="">Terminal Command</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/os/mac-os/terminal-command/text-processing-and-searching/" class="">Text Processing and Searching</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-73eee81d29f3d1d06e3ced5db70613c1" class="toggle" checked />
    <label for="section-73eee81d29f3d1d06e3ced5db70613c1" class="flex justify-between">
      <a role="button" class="">Web</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-a913ce247e99bf5334ae2e3cbeee0f90" class="toggle" checked />
    <label for="section-a913ce247e99bf5334ae2e3cbeee0f90" class="flex justify-between">
      <a role="button" class="">Glossary</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web/glossary/cors/" class="active">CORS</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-01867ca5de591b785e2c310209ee8cb4" class="toggle"  />
    <label for="section-01867ca5de591b785e2c310209ee8cb4" class="flex justify-between">
      <a role="button" class="">Web API</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web/web-api/web-storage-api/" class="">Web Storage Api</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-4da064fabd249335787f92ae73011b1b" class="toggle"  />
    <label for="section-4da064fabd249335787f92ae73011b1b" class="flex justify-between">
      <a role="button" class="">HTTP</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web/http/start-http/" class="">Start HTTP</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web/http/http-methods-and-status-codes/" class="">HTTP Methods &amp; Status Codes</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web/http/http-header-part-1/" class="">HTTP Headers Part 1</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web/http/http-header-part-2/" class="">HTTP Headers Part 2: Content-Type &amp; Accept</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web/http/http-header-part-3/" class="">HTTP Headers Part 3: Cache-Control</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web/http/cookie/" class="">Cookie</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-6441cb17542fe8006e427b6b0a94d041" class="toggle"  />
    <label for="section-6441cb17542fe8006e427b6b0a94d041" class="flex justify-between">
      <a role="button" class="">Security</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web/security/asymmetric-encryption/" class="">Asymmetric Encryption</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web/security/session-vs-token/" class="">Session vs Token</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web/security/tls-handshake/" class="">TLS Handshake</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web/security/tls-handshake-client-hello/" class="">TLS Handshake: Client Hello</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web/security/tls-handshake-server-hello/" class="">TLS Handshake: Server Hello</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web/security/tls-handshake-certificate/" class="">TLS Handshake: Certificate</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web/security/tls-handshake-certificate-verify/" class="">TLS Handshake: Certificate Verify</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web/security/tls-handshake-certificate-finished/" class="">TLS Handshake: Finished</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-43effcc73883f6032917b714430cd064" class="toggle"  />
    <label for="section-43effcc73883f6032917b714430cd064" class="flex justify-between">
      <a role="button" class="">Tools</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-13ffff656c2dc3dfe4c18658b113a7be" class="toggle"  />
    <label for="section-13ffff656c2dc3dfe4c18658b113a7be" class="flex justify-between">
      <a role="button" class="">Hugo</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/tools/hugo/set-up-hugo-in-git-hub-pages/" class="">Set Up Hugo in Git Hub Pages</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-435c533cf8e83924f036a3fc06649777" class="toggle"  />
    <label for="section-435c533cf8e83924f036a3fc06649777" class="flex justify-between">
      <a role="button" class="">Aws</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/aws/cloudformation/" class="">CloudFormation</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-62258074df8a7a4253e368d8300827d8" class="toggle"  />
    <label for="section-62258074df8a7a4253e368d8300827d8" class="flex justify-between">
      <a role="button" class="">Message</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/aws/message/sns/" class="">SNS</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/aws/message/sqs/" class="">SQS</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/aws/message/eventbridge/" class="">EventBridge</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-5214fd1aa07e57317f87d16d6d714389" class="toggle"  />
    <label for="section-5214fd1aa07e57317f87d16d6d714389" class="flex justify-between">
      <a role="button" class="">Security</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/aws/security/kms/" class="">KMS</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-f08994ed3456b39a7f1229df10e15d9f" class="toggle"  />
    <label for="section-f08994ed3456b39a7f1229df10e15d9f" class="flex justify-between">
      <a role="button" class="">Network</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/network/dns/" class="">DNS</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/network/dns-hands-on/" class="">DNS Hands On</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/network/id-address/" class="">IP Address</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/network/cird/" class="">CIRD</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/network/subnet/" class="">Subnet</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-4634b8a2422e3042385f4c14a0822f58" class="toggle"  />
    <label for="section-4634b8a2422e3042385f4c14a0822f58" class="flex justify-between">
      <a role="button" class="">System Design</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-635ac14c32f4b096cb88b04c783b749f" class="toggle"  />
    <label for="section-635ac14c32f4b096cb88b04c783b749f" class="flex justify-between">
      <a role="button" class="">Design Data Intensive Applications</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/system-design/design-data-intensive-applications/replication/" class="">Replication</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/system-design/design-data-intensive-applications/partition/" class="">Partition</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/system-design/design-data-intensive-applications/transactions/" class="">Transactions</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-43f8309f7625d11a21842e4f1759c1f1" class="toggle"  />
    <label for="section-43f8309f7625d11a21842e4f1759c1f1" class="flex justify-between">
      <a role="button" class="">Load Balancing</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/system-design/load-balancing/load-balancer/" class="">Load Balancer</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-2a6004e8987d26d95ed1c07df5a63b81" class="toggle"  />
    <label for="section-2a6004e8987d26d95ed1c07df5a63b81" class="flex justify-between">
      <a role="button" class="">Haproxy</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/system-design/load-balancing/haproxy/get-start/" class="">HAProxy: Get Started</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/system-design/load-balancing/haproxy/health-check/" class="">HAProxy: Health Check</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/system-design/load-balancing/haproxy/load-balancing-algorithm/" class="">HAProxy: Load Balancing Algorithem</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/system-design/load-balancing/haproxy/layer7-load-balancing/" class="">HAProxy: HTTP (Layer 7) Load Balancing</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/system-design/load-balancing/haproxy/http-sticky-sessions-cookies/" class="">HAProxy: Sticky Sessions Using Cookies</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-d6b5a5ebe02e8f45cd65f61120086e8f" class="toggle"  />
    <label for="section-d6b5a5ebe02e8f45cd65f61120086e8f" class="flex justify-between">
      <a role="button" class="">Monitoring</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/system-design/monitoring/metric-log/" class="">Metric &amp; Log</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-5b4a6554295593bd19ab191ce0f0890a" class="toggle"  />
    <label for="section-5b4a6554295593bd19ab191ce0f0890a" class="flex justify-between">
      <a role="button" class="">Technology</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-e65dadec602a3e741624a6eace4b2779" class="toggle"  />
    <label for="section-e65dadec602a3e741624a6eace4b2779" class="flex justify-between">
      <a role="button" class="">Docker</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/system-design/technology/docker/docker-basics/" class="">Docker Basics</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-82f8da13d6fac792702112b64522aa5d" class="toggle"  />
    <label for="section-82f8da13d6fac792702112b64522aa5d" class="flex justify-between">
      <a role="button" class="">Redis</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/system-design/technology/redis/why-is-redis-so-fast/" class="">Why Is Redis So Fast</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/system-design/technology/redis/data-presistence/" class="">Data Persistence</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/system-design/technology/redis/pub-sub/" class="">Redis Pub/Sub</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/system-design/technology/redis/replication-and-sentinel/" class="">Redis Replication &amp; Sentinel</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>














</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <h3>CORS</h3>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li>
          <ul>
            <li><a href="#whats-cors">What&rsquo;s CORS</a></li>
            <li><a href="#why-needs-cors">Why needs CORS</a></li>
            <li><a href="#access-control-allow-origin-header"><code>Access-Control-Allow-Origin</code> Header</a></li>
            <li><a href="#access-control-allow-methods-header"><code>Access-Control-Allow-Methods</code> Header</a></li>
            <li><a href="#preflight-request">Preflight Request</a></li>
            <li><a href="#access-control-allow-credentials-header"><code>Access-Control-Allow-Credentials</code> Header</a></li>
            <li><a href="#access-control-allow-headers-header"><code>Access-Control-Allow-Headers</code> Header</a></li>
            <li><a href="#reference">Reference</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown book-article"><h3 id="whats-cors">
  What&rsquo;s CORS
  <a class="anchor" href="#whats-cors">#</a>
</h3>
<p><code>CORS</code> is a mechanism to stop you from accessing resource in one origin from another origin. For example, there is an image <code>img.jpg</code> from origin <code>images.com</code>, if you don&rsquo;t have CORS set properly, you can&rsquo;t access the <code>img.jpg</code> from other origins like <code>yourOrigin.com</code>.</p>
<h3 id="why-needs-cors">
  Why needs CORS
  <a class="anchor" href="#why-needs-cors">#</a>
</h3>
<p><code>CORS</code> is mainly for security usage. Image that your browser stores credential cookies of domain <code>bank.com</code> which is the website of you bank account, and a hacking website <code>hacking.com</code> want to access your bank information and make a transaction from your bank. If without CORS, the javascript script from <code>hacking.com</code> is able to get the cookies under domain <code>bank.com</code> and make requests to <code>bank.com</code>.
<code>CORS</code> can protect your website from malicious requests</p>
<h3 id="access-control-allow-origin-header">
  <code>Access-Control-Allow-Origin</code> Header
  <a class="anchor" href="#access-control-allow-origin-header">#</a>
</h3>
<h4 id="issue-demonstration">
  Issue Demonstration
  <a class="anchor" href="#issue-demonstration">#</a>
</h4>
<p>Start a local host</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">express</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#34;express&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">app</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">express</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#39;/&#39;</span>, (<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>) =&gt; {
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">json</span>({ <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Hello&#34;</span>, <span style="color:#a6e22e">value</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;World&#34;</span>})
</span></span><span style="display:flex;"><span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">listen</span>(<span style="color:#ae81ff">3000</span>);
</span></span></code></pre></div><p>In your browser, navigate to <code>http://localhost:3000</code>. Open console and make a <code>GET</code> request to <code>http://localhost:3000</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#a6e22e">fetch</span>(<span style="color:#e6db74">&#34;http://localhost:3000&#34;</span>).<span style="color:#a6e22e">then</span>((<span style="color:#a6e22e">req</span>) =&gt; <span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">json</span>()).<span style="color:#a6e22e">then</span>(<span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>);
</span></span></code></pre></div><p>You will receive a successful response</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span>{<span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Hello&#39;</span>, <span style="color:#a6e22e">value</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;World&#39;</span>}
</span></span></code></pre></div><p>You didn&rsquo;t see any <code>CORS</code> issues, cause you were making request from <code>http://localhost:3000</code> to same origin.</p>
<p>Open a new tab in your browser, navigate to <code>www.google.com</code>, and make a same request. You will see error like:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#a6e22e">Access</span> <span style="color:#a6e22e">to</span> <span style="color:#a6e22e">fetch</span> <span style="color:#a6e22e">at</span> <span style="color:#e6db74">&#39;http://localhost:3000/&#39;</span> <span style="color:#a6e22e">from</span> <span style="color:#a6e22e">origin</span> <span style="color:#e6db74">&#39;https://www.google.com&#39;</span> <span style="color:#a6e22e">has</span> <span style="color:#a6e22e">been</span> <span style="color:#a6e22e">blocked</span> <span style="color:#a6e22e">by</span> <span style="color:#a6e22e">CORS</span> <span style="color:#a6e22e">policy</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">No</span> <span style="color:#e6db74">&#39;Access-Control-Allow-Origin&#39;</span> <span style="color:#a6e22e">header</span> <span style="color:#a6e22e">is</span> <span style="color:#a6e22e">present</span> <span style="color:#a6e22e">on</span> <span style="color:#a6e22e">the</span> <span style="color:#a6e22e">requested</span> <span style="color:#a6e22e">resource</span>. <span style="color:#a6e22e">If</span> <span style="color:#a6e22e">an</span> <span style="color:#a6e22e">opaque</span> <span style="color:#a6e22e">response</span> <span style="color:#a6e22e">serves</span> <span style="color:#a6e22e">your</span> <span style="color:#a6e22e">needs</span>, <span style="color:#a6e22e">set</span> <span style="color:#a6e22e">the</span> <span style="color:#a6e22e">request</span><span style="color:#e6db74">&#39;s mode to &#39;</span><span style="color:#a6e22e">no</span><span style="color:#f92672">-</span><span style="color:#a6e22e">cors</span><span style="color:#960050;background-color:#1e0010">&#39;</span> <span style="color:#a6e22e">to</span> <span style="color:#a6e22e">fetch</span> <span style="color:#a6e22e">the</span> <span style="color:#a6e22e">resource</span> <span style="color:#66d9ef">with</span> <span style="color:#a6e22e">CORS</span> <span style="color:#a6e22e">disabled</span>.
</span></span></code></pre></div><h4 id="solution">
  Solution
  <a class="anchor" href="#solution">#</a>
</h4>
<p>Add <code>www.google.com</code> in allowed origins in your <code>CORS</code> config</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">express</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#34;express&#34;</span>);
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">app</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">express</span>();
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">cors</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">require</span>(<span style="color:#e6db74">&#34;cors&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">use</span>(<span style="color:#a6e22e">cors</span>({
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">origin</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;https://www.google.com&#34;</span>
</span></span><span style="display:flex;"><span>}));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#39;/&#39;</span>, (<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>) =&gt; {
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">json</span>({ <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Hello&#34;</span>, <span style="color:#a6e22e">value</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;World&#34;</span>})
</span></span><span style="display:flex;"><span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">listen</span>(<span style="color:#ae81ff">3000</span>);
</span></span></code></pre></div><p>Make a same request again to local host, and the error is gone and you will see response printed in console:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span>{<span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Hello&#39;</span>, <span style="color:#a6e22e">value</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;World&#39;</span>}
</span></span></code></pre></div><h3 id="access-control-allow-methods-header">
  <code>Access-Control-Allow-Methods</code> Header
  <a class="anchor" href="#access-control-allow-methods-header">#</a>
</h3>
<h4 id="problem-demonstration">
  Problem Demonstration
  <a class="anchor" href="#problem-demonstration">#</a>
</h4>
<p>To demonstration the problem with <code>Access-Control-Allow-Methods</code> header</p>
<ul>
<li>I add <code>GET</code> and <code>POST</code> as allowed methods in <code>CORS</code> config, which limits that clients can only use <code>GET</code> or <code>POST</code> methods in their requests to the server</li>
<li>Also, I changed the method provided by the server from <code>GET</code> to <code>PUT</code></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">use</span>(<span style="color:#a6e22e">cors</span>({
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">origin</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;https://www.google.com&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">methods</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#34;GET&#34;</span>, <span style="color:#e6db74">&#34;POST&#34;</span>],
</span></span><span style="display:flex;"><span>}));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">put</span>(<span style="color:#e6db74">&#39;/&#39;</span>, (<span style="color:#a6e22e">req</span>, <span style="color:#a6e22e">res</span>) =&gt; {
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">json</span>({ <span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;Hello&#34;</span>, <span style="color:#a6e22e">value</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;World&#34;</span>})
</span></span><span style="display:flex;"><span>});
</span></span></code></pre></div><p>Then let&rsquo;s make request in the console under <code>www.google.com</code> domain</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#a6e22e">fetch</span>(<span style="color:#e6db74">&#34;http://localhost:3000&#34;</span>, {<span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;PUT&#34;</span>}).<span style="color:#a6e22e">then</span>((<span style="color:#a6e22e">req</span>) =&gt; <span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">json</span>()).<span style="color:#a6e22e">then</span>(<span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>);
</span></span></code></pre></div><p>We will see error:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#a6e22e">www</span>.<span style="color:#a6e22e">google</span>.<span style="color:#a6e22e">com</span><span style="color:#f92672">/:</span><span style="color:#ae81ff">1</span> <span style="color:#a6e22e">Access</span> <span style="color:#a6e22e">to</span> <span style="color:#a6e22e">fetch</span> <span style="color:#a6e22e">at</span> <span style="color:#e6db74">&#39;http://localhost:3000/&#39;</span> <span style="color:#a6e22e">from</span> <span style="color:#a6e22e">origin</span> <span style="color:#e6db74">&#39;https://www.google.com&#39;</span> <span style="color:#a6e22e">has</span> <span style="color:#a6e22e">been</span> <span style="color:#a6e22e">blocked</span> <span style="color:#a6e22e">by</span> <span style="color:#a6e22e">CORS</span> <span style="color:#a6e22e">policy</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">Method</span> <span style="color:#a6e22e">PUT</span> <span style="color:#a6e22e">is</span> <span style="color:#a6e22e">not</span> <span style="color:#a6e22e">allowed</span> <span style="color:#a6e22e">by</span> <span style="color:#a6e22e">Access</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Control</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Allow</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Methods</span> <span style="color:#66d9ef">in</span> <span style="color:#a6e22e">preflight</span> <span style="color:#a6e22e">response</span>.
</span></span></code></pre></div><h4 id="solution-1">
  Solution
  <a class="anchor" href="#solution-1">#</a>
</h4>
<p>Add <code>PUT</code> in allowed methods</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">use</span>(<span style="color:#a6e22e">cors</span>({
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">origin</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;https://www.google.com&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">methods</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#34;GET&#34;</span>, <span style="color:#e6db74">&#34;POST&#34;</span>, <span style="color:#e6db74">&#34;PUT&#34;</span>],
</span></span><span style="display:flex;"><span>}));
</span></span></code></pre></div><p>Make the same request from <code>www.google.com</code> again, and this time the error was gone and we receive correct response.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span>{<span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;Hello&#39;</span>, <span style="color:#a6e22e">value</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;World&#39;</span>}
</span></span></code></pre></div><p>Checking console, we can see two requests, the first request, which is called preflight request, and its response header is lik below:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#a6e22e">HTTP</span><span style="color:#f92672">/</span><span style="color:#ae81ff">1.1</span> <span style="color:#ae81ff">204</span> <span style="color:#a6e22e">No</span> <span style="color:#a6e22e">Content</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Access</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Control</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Allow</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Origin</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">https</span><span style="color:#f92672">:</span><span style="color:#75715e">//www.google.com
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">Vary</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">Origin</span>, <span style="color:#a6e22e">Access</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Control</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Request</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Headers</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Access</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Control</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Allow</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Methods</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">GET</span>,<span style="color:#a6e22e">POST</span>,<span style="color:#a6e22e">PUT</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Content</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Length</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Connection</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">keep</span><span style="color:#f92672">-</span><span style="color:#a6e22e">alive</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Keep</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Alive</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">timeout</span><span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>
</span></span></code></pre></div><p>The headers tell the browser that cross-origin request to &lsquo;http://localhost:3000/&rsquo; is allowed for origin <code>https://www.google.com</code>, but only applies to three methods: <code>GET</code>, <code>POST</code> and <code>PUT</code>, which are same as what we defined in our <code>CORS</code> config.</p>
<p>Another request is the real cross-origin request, with <code>PUT</code> method, and server returns response with content.</p>
<h3 id="preflight-request">
  Preflight Request
  <a class="anchor" href="#preflight-request">#</a>
</h3>
<p>We demonstrate <code>Access-Control-Allow-Methods</code> problem, but what is preflight response in above error</p>
<ul>
<li>Preflight request is an <code>OPTIONS</code> request automatically sent by browser before a cross origin request.</li>
<li>Preflight request is used to determine if a cross origin request is safe.</li>
<li>Preflight request including header <code>Origin</code>, <code>Access-Control-Request-Method</code> and <code>Access-Control-Request-Headers</code> (Optional)</li>
</ul>
<h4 id="how-does-preflight-request-work">
  How Does Preflight Request Work
  <a class="anchor" href="#how-does-preflight-request-work">#</a>
</h4>
<ul>
<li>Browser sends an <code>OPTIONS</code> request to the server with headers mentioned above</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#a6e22e">OPTIONS</span> <span style="color:#f92672">/</span> <span style="color:#a6e22e">HTTP</span><span style="color:#f92672">/</span><span style="color:#ae81ff">1.1</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Access</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Control</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Request</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Method</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">PUT</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Host</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">localhost</span><span style="color:#f92672">:</span><span style="color:#ae81ff">3000</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Origin</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">https</span><span style="color:#f92672">:</span><span style="color:#75715e">//www.google.com
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">Sec</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Fetch</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Mode</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">cors</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Sec</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Fetch</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Site</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">cross</span><span style="color:#f92672">-</span><span style="color:#a6e22e">site</span>
</span></span></code></pre></div><ul>
<li>
<p>Server receives the preflight request and check its <code>CORS</code> configuration. It determines if the real cross-origin request has proper permission by checking origin, method and headers in the preflight request</p>
</li>
<li>
<p>If the real request is allowed, server responds to the preflight request with appropriate <code>CORS</code> headers, including allowed origins, methods and headers.</p>
</li>
<li>
<p>After receiving preflight response from the server, if the server allows the request, then browser will send the real cross-origin request to the server. If not, browser will block the request and prevent it from reaching the server</p>
</li>
</ul>
<p>If we include headers in the request</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#a6e22e">fetch</span>(<span style="color:#e6db74">&#34;http://localhost:3000&#34;</span>, {
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;PUT&#34;</span>, 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">headers</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;Customer-Header&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;key=value&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;X-Customer-Header&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;key=value&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;Cookie&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;value&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>}).<span style="color:#a6e22e">then</span>((<span style="color:#a6e22e">req</span>) =&gt; <span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">json</span>()).<span style="color:#a6e22e">then</span>(<span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>);
</span></span></code></pre></div><p>Here we include two customer headers: <code>Customer-Header</code> and <code>X-Customer-Header</code>, and the preflight request and response are like below</p>
<ul>
<li>Request</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#a6e22e">OPTIONS</span> <span style="color:#f92672">/</span> <span style="color:#a6e22e">HTTP</span><span style="color:#f92672">/</span><span style="color:#ae81ff">1.1</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Access</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Control</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Request</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Headers</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">customer</span><span style="color:#f92672">-</span><span style="color:#a6e22e">header</span>,<span style="color:#a6e22e">x</span><span style="color:#f92672">-</span><span style="color:#a6e22e">customer</span><span style="color:#f92672">-</span><span style="color:#a6e22e">header</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Access</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Control</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Request</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Method</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">PUT</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Host</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">localhost</span><span style="color:#f92672">:</span><span style="color:#ae81ff">3000</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Origin</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">https</span><span style="color:#f92672">:</span><span style="color:#75715e">//www.google.com
</span></span></span></code></pre></div><p>Some headers are omitted, but you can see here preflight request tells server which headers are included in the cross-origin request.</p>
<ul>
<li>Response</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#a6e22e">HTTP</span><span style="color:#f92672">/</span><span style="color:#ae81ff">1.1</span> <span style="color:#ae81ff">204</span> <span style="color:#a6e22e">No</span> <span style="color:#a6e22e">Content</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Access</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Control</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Allow</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Origin</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">https</span><span style="color:#f92672">:</span><span style="color:#75715e">//www.google.com
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#a6e22e">Access</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Control</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Allow</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Methods</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">GET</span>,<span style="color:#a6e22e">POST</span>,<span style="color:#a6e22e">PUT</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">Access</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Control</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Allow</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Headers</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">customer</span><span style="color:#f92672">-</span><span style="color:#a6e22e">header</span>,<span style="color:#a6e22e">x</span><span style="color:#f92672">-</span><span style="color:#a6e22e">customer</span><span style="color:#f92672">-</span><span style="color:#a6e22e">header</span>
</span></span></code></pre></div><h3 id="access-control-allow-credentials-header">
  <code>Access-Control-Allow-Credentials</code> Header
  <a class="anchor" href="#access-control-allow-credentials-header">#</a>
</h3>
<p>The <code>Access-Control-Allow-Credentials</code> response header tells browsers whether to expose the response to the frontend JavaScript code when the request&rsquo;s credentials mode (Request.credentials) is include.</p>
<h4 id="issue-demonstration-1">
  Issue Demonstration
  <a class="anchor" href="#issue-demonstration-1">#</a>
</h4>
<p>Make below call in your browser console under Google domain</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#a6e22e">fetch</span>(<span style="color:#e6db74">&#34;http://localhost:3000&#34;</span>, {
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;PUT&#34;</span>, 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">credentials</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;include&#34;</span>
</span></span><span style="display:flex;"><span>}).<span style="color:#a6e22e">then</span>((<span style="color:#a6e22e">req</span>) =&gt; <span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">json</span>()).<span style="color:#a6e22e">then</span>(<span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>);
</span></span></code></pre></div><p>You will see error message:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#a6e22e">Access</span> <span style="color:#a6e22e">to</span> <span style="color:#a6e22e">fetch</span> <span style="color:#a6e22e">at</span> <span style="color:#e6db74">&#39;http://localhost:3000/&#39;</span> <span style="color:#a6e22e">from</span> <span style="color:#a6e22e">origin</span> <span style="color:#e6db74">&#39;https://www.google.com&#39;</span> <span style="color:#a6e22e">has</span> <span style="color:#a6e22e">been</span> <span style="color:#a6e22e">blocked</span> <span style="color:#a6e22e">by</span> <span style="color:#a6e22e">CORS</span> <span style="color:#a6e22e">policy</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">Response</span> <span style="color:#a6e22e">to</span> <span style="color:#a6e22e">preflight</span> <span style="color:#a6e22e">request</span> <span style="color:#a6e22e">doesn</span><span style="color:#e6db74">&#39;t pass access control check: The value of the &#39;</span><span style="color:#a6e22e">Access</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Control</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Allow</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Credentials</span><span style="color:#e6db74">&#39; header in the response is &#39;&#39; which must be &#39;</span><span style="color:#66d9ef">true</span><span style="color:#e6db74">&#39; when the request&#39;</span><span style="color:#a6e22e">s</span> <span style="color:#a6e22e">credentials</span> <span style="color:#a6e22e">mode</span> <span style="color:#a6e22e">is</span> <span style="color:#e6db74">&#39;include&#39;</span>.
</span></span></code></pre></div><p>That is because you want to include credentials, including cookies, authorization headers, or TLS client certificates, in your request.</p>
<p>Remember if you don&rsquo;t explicitly specify <code>credentials: &quot;include&quot;</code> in your request, cookies will not be added in your request&rsquo;s headers</p>
<h4 id="solution-2">
  Solution
  <a class="anchor" href="#solution-2">#</a>
</h4>
<p>Set <code>credentials</code> to <code>true</code> in server&rsquo;s <code>CORS</code> config</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">use</span>(<span style="color:#a6e22e">cors</span>({
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">origin</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;https://www.google.com&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">methods</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#34;GET&#34;</span>, <span style="color:#e6db74">&#34;POST&#34;</span>, <span style="color:#e6db74">&#34;PUT&#34;</span>],
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">credentials</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>}));
</span></span></code></pre></div><h3 id="access-control-allow-headers-header">
  <code>Access-Control-Allow-Headers</code> Header
  <a class="anchor" href="#access-control-allow-headers-header">#</a>
</h3>
<p>Used in response to a preflight request to indicate which HTTP headers can be used when making the actual request.</p>
<h4 id="problem-demonstration-1">
  Problem Demonstration
  <a class="anchor" href="#problem-demonstration-1">#</a>
</h4>
<p>Limit <code>Content-Type</code> as the only header which server allowed</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">use</span>(<span style="color:#a6e22e">cors</span>({
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">origin</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;https://www.google.com&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">methods</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#34;GET&#34;</span>, <span style="color:#e6db74">&#34;POST&#34;</span>, <span style="color:#e6db74">&#34;PUT&#34;</span>],
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">allowedHeaders</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#39;Content-Type&#39;</span>]
</span></span><span style="display:flex;"><span>}));
</span></span></code></pre></div><p>Then make a call from Google domain with two customer headers</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#a6e22e">fetch</span>(<span style="color:#e6db74">&#34;http://localhost:3000&#34;</span>, {
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">method</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;PUT&#34;</span>, 
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">headers</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;Customer-Header&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;key=value&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;X-Customer-Header&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;key=value&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;Cookie&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;value&#34;</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>}).<span style="color:#a6e22e">then</span>((<span style="color:#a6e22e">req</span>) =&gt; <span style="color:#a6e22e">req</span>.<span style="color:#a6e22e">json</span>()).<span style="color:#a6e22e">then</span>(<span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>);
</span></span></code></pre></div><p>The request was denied with below error message</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#a6e22e">Access</span> <span style="color:#a6e22e">to</span> <span style="color:#a6e22e">fetch</span> <span style="color:#a6e22e">at</span> <span style="color:#e6db74">&#39;http://localhost:3000/&#39;</span> <span style="color:#a6e22e">from</span> <span style="color:#a6e22e">origin</span> <span style="color:#e6db74">&#39;https://www.google.com&#39;</span> <span style="color:#a6e22e">has</span> <span style="color:#a6e22e">been</span> <span style="color:#a6e22e">blocked</span> <span style="color:#a6e22e">by</span> <span style="color:#a6e22e">CORS</span> <span style="color:#a6e22e">policy</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">Request</span> <span style="color:#a6e22e">header</span> <span style="color:#a6e22e">field</span> <span style="color:#a6e22e">customer</span><span style="color:#f92672">-</span><span style="color:#a6e22e">header</span> <span style="color:#a6e22e">is</span> <span style="color:#a6e22e">not</span> <span style="color:#a6e22e">allowed</span> <span style="color:#a6e22e">by</span> <span style="color:#a6e22e">Access</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Control</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Allow</span><span style="color:#f92672">-</span><span style="color:#a6e22e">Headers</span> <span style="color:#66d9ef">in</span> <span style="color:#a6e22e">preflight</span> <span style="color:#a6e22e">response</span>.
</span></span></code></pre></div><h4 id="solution-3">
  Solution
  <a class="anchor" href="#solution-3">#</a>
</h4>
<p>Add customers header as allowed headers</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">use</span>(<span style="color:#a6e22e">cors</span>({
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">origin</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;https://www.google.com&#34;</span>,
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">methods</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#34;GET&#34;</span>, <span style="color:#e6db74">&#34;POST&#34;</span>, <span style="color:#e6db74">&#34;PUT&#34;</span>],
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">allowedHeaders</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#34;Content-Type&#34;</span>, <span style="color:#e6db74">&#34;Customer-Header&#34;</span>, <span style="color:#e6db74">&#34;X-Customer-Header&#34;</span>],
</span></span><span style="display:flex;"><span>}));
</span></span></code></pre></div><h3 id="reference">
  Reference
  <a class="anchor" href="#reference">#</a>
</h3>
<ul>
<li><a href="https://www.youtube.com/watch?v=PNtFSVU-YTI">YouTube video</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Glossary/CORS">CORS</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Glossary/Preflight_request">Preflight Request</a></li>
<li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Credentials">Access-Control-Allow-Credentials</a></li>
</ul>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>



  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li>
          <ul>
            <li><a href="#whats-cors">What&rsquo;s CORS</a></li>
            <li><a href="#why-needs-cors">Why needs CORS</a></li>
            <li><a href="#access-control-allow-origin-header"><code>Access-Control-Allow-Origin</code> Header</a></li>
            <li><a href="#access-control-allow-methods-header"><code>Access-Control-Allow-Methods</code> Header</a></li>
            <li><a href="#preflight-request">Preflight Request</a></li>
            <li><a href="#access-control-allow-credentials-header"><code>Access-Control-Allow-Credentials</code> Header</a></li>
            <li><a href="#access-control-allow-headers-header"><code>Access-Control-Allow-Headers</code> Header</a></li>
            <li><a href="#reference">Reference</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












