<!DOCTYPE html>
<html lang="en-us" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="
  Unblocking Mode
  #

In last post, we discussed blocking mode and its problems. In this post, we will discuss unblocking mode and its problems

  Code Example
  #



Server
@Slf4j
public class Server {
    public static void main(String[] args) throws IOException {
        ByteBuffer buffer = ByteBuffer.allocate(32);

        ServerSocketChannel ssc = ServerSocketChannel.open();
        ssc.bind(new InetSocketAddress(9999));

        ssc.configureBlocking(false);

        List&lt;SocketChannel&gt; channels = new ArrayList&lt;&gt;();
        while (true) {
            log.debug(&#34;Server connecting&#34;);
            SocketChannel sc = ssc.accept();
            if (sc != null) {
                log.debug(&#34;Connect to client &#34; &#43; sc.getRemoteAddress());
                sc.configureBlocking(false);
                channels.add(sc);
            }
            for (SocketChannel channel : channels) {
                log.debug(&#34;Server reading&#34;);
                int read = channel.read(buffer);
                if (read != 0) {
                    buffer.flip();
                    ByteBufferReader.readAll(buffer);
                    buffer.clear();
                    log.debug(&#34;Read data from client &#34; &#43; channel.getRemoteAddress());
                }
            }
        }
    }
}

Comparing with server code of blocking mode, we set blocking configuration of the ServerSocketChannel and SocketChannel to false
ssc.configureBlocking(false);
sc.configureBlocking(false);

Also we add a conditional check before adding the SocketChannel to the list and reading data from the channel. That is because in unblocking mode, method scc.accept() will not be blocked, instead it returns a SocketChannel object or null depending on if a client connects to the server. Hence, we should only add the SocketChannel to the list if it is not null, in other words, a client connects to the server.
Method channel.read(buffer) will always read from the Channel no matter clients send data or not. What the method returns is the length of bytes it reads. Here we only handle the data if len &gt; 0
if (sc != null) {
    ...
}
if (read != 0) {
    ...
}




Client">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="https://whatsBehind.github.io/docs/programming/backend/java/nio/unblocking-mode/">
  <meta property="og:site_name" content="What&#39;s Behind">
  <meta property="og:title" content="Unblocking Mode">
  <meta property="og:description" content="Unblocking Mode # In last post, we discussed blocking mode and its problems. In this post, we will discuss unblocking mode and its problems
Code Example # Server
@Slf4j public class Server { public static void main(String[] args) throws IOException { ByteBuffer buffer = ByteBuffer.allocate(32); ServerSocketChannel ssc = ServerSocketChannel.open(); ssc.bind(new InetSocketAddress(9999)); ssc.configureBlocking(false); List&lt;SocketChannel&gt; channels = new ArrayList&lt;&gt;(); while (true) { log.debug(&#34;Server connecting&#34;); SocketChannel sc = ssc.accept(); if (sc != null) { log.debug(&#34;Connect to client &#34; &#43; sc.getRemoteAddress()); sc.configureBlocking(false); channels.add(sc); } for (SocketChannel channel : channels) { log.debug(&#34;Server reading&#34;); int read = channel.read(buffer); if (read != 0) { buffer.flip(); ByteBufferReader.readAll(buffer); buffer.clear(); log.debug(&#34;Read data from client &#34; &#43; channel.getRemoteAddress()); } } } } } Comparing with server code of blocking mode, we set blocking configuration of the ServerSocketChannel and SocketChannel to false ssc.configureBlocking(false); sc.configureBlocking(false); Also we add a conditional check before adding the SocketChannel to the list and reading data from the channel. That is because in unblocking mode, method scc.accept() will not be blocked, instead it returns a SocketChannel object or null depending on if a client connects to the server. Hence, we should only add the SocketChannel to the list if it is not null, in other words, a client connects to the server. Method channel.read(buffer) will always read from the Channel no matter clients send data or not. What the method returns is the length of bytes it reads. Here we only handle the data if len &gt; 0 if (sc != null) { ... } if (read != 0) { ... } Client">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="docs">
<title>Unblocking Mode | What&#39;s Behind</title>
<link rel="icon" href="/favicon.png" >
<link rel="manifest" href="/manifest.json">
<link rel="canonical" href="https://whatsBehind.github.io/docs/programming/backend/java/nio/unblocking-mode/">
<link rel="stylesheet" href="/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css" integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin="anonymous">
  <script defer src="/fuse.min.js"></script>
  <script defer src="/en.search.min.1af3585ae9ce361dc49ec76c92ef08c3ba76a31f1e310771dfe04284db5d58c4.js" integrity="sha256-GvNYWunONh3Ensdsku8Iw7p2ox8eMQdx3&#43;BChNtdWMQ=" crossorigin="anonymous"></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><span>What&#39;s Behind</span>
  </a>
</h2>


<div class="book-search hidden">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>















  
  <ul>
    
      
        <li>
          
  
  

  
    <span>Programming</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-a3774d0b7f222c1fd859911bed9f84c7" class="toggle" checked />
    <label for="section-a3774d0b7f222c1fd859911bed9f84c7" class="flex justify-between">
      <a role="button" class="">Backend</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-d89b2e5681262822056a3eec9d0a41e4" class="toggle" checked />
    <label for="section-d89b2e5681262822056a3eec9d0a41e4" class="flex justify-between">
      <a role="button" class="">Java</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-ac19ec90cf736954489e2a5e8571a790" class="toggle" checked />
    <label for="section-ac19ec90cf736954489e2a5e8571a790" class="flex justify-between">
      <a role="button" class="">Nio</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/nio/byte-buffer/" class="">Byte Buffer</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/nio/blocking-mode/" class="">Blocking Mode</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/nio/unblocking-mode/" class="active">Unblocking Mode</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/nio/selector/" class="">Selector</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/nio/selector-read/" class="">Selector Read</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/nio/io-model-summary/" class="">I/O  Model Summary</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/nio/multiple-threads/" class="">Multiple Threads</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-3a8a021e398721afe1d6aaefc5a53581" class="toggle"  />
    <label for="section-3a8a021e398721afe1d6aaefc5a53581" class="flex justify-between">
      <a role="button" class="">Net</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/net/tcp-socket/" class="">Tcp Socket</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-30dab7aa6f04e2575ba9575d3f7aa552" class="toggle"  />
    <label for="section-30dab7aa6f04e2575ba9575d3f7aa552" class="flex justify-between">
      <a role="button" class="">Io</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/io/decorator-pattern-in-java-io/" class="">Decorator Pattern in Java IO</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/io/object-input-and-output-stream/" class="">ObjectInputStream and ObjectOutputStream</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/io/stream-reader-bridge-of-byte-and-char/" class="">Stream Reader: Bridge of Byte and Char</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/io/io-stream/" class="">Java IO Stream</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/io/file/" class="">Java File</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-12abf7232ea9d442045b1411b7978a30" class="toggle"  />
    <label for="section-12abf7232ea9d442045b1411b7978a30" class="flex justify-between">
      <a role="button" class="">Thread</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/thread/start-thread/" class="">Start Thread</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/thread/common-methods/" class="">Common Methods</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/thread/thread-lifecycle/" class="">Thread Lifecycle</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/thread/synchornization/" class="">Synchronization</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/thread/thread-safety/" class="">Thread Safety</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/reflection/" class="">Reflection</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-de3ec6a026b81e65f77c5a7c0f2cd777" class="toggle"  />
    <label for="section-de3ec6a026b81e65f77c5a7c0f2cd777" class="flex justify-between">
      <a role="button" class="">Netty</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/netty/event-loop-group/" class="">EventLoop &amp; EventLoopGroup</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/netty/channel/" class="">Channel &amp; ChannelFuture</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/netty/pipeline-handler/" class="">Pipeline &amp; Handler</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-7fca83de470936b8f46c9d214eb96e6f" class="toggle"  />
    <label for="section-7fca83de470936b8f46c9d214eb96e6f" class="flex justify-between">
      <a role="button" class="">API</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/api/restful-get/" class="">RESTful GET</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-3267b427ef0b7fb8be17928f82652d59" class="toggle"  />
    <label for="section-3267b427ef0b7fb8be17928f82652d59" class="flex justify-between">
      <a role="button" class="">Python</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/python/executing-a-python-file/" class="">How Is Python File Executed</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/python/re/" class="">RegEx</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/python/format-string/" class="">format-string</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-9488811b2da44d814b719a324549338f" class="toggle"  />
    <label for="section-9488811b2da44d814b719a324549338f" class="flex justify-between">
      <a role="button" class="">Project</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/project/online-chat/" class="">Online Chat</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/project/node-js-auth/" class="">Node Js Auth</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-15e5b6cfbe135e4220353ad911edbc9a" class="toggle"  />
    <label for="section-15e5b6cfbe135e4220353ad911edbc9a" class="flex justify-between">
      <a role="button" class="">Os</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-128d8751d4236191f55b9181cd918421" class="toggle"  />
    <label for="section-128d8751d4236191f55b9181cd918421" class="flex justify-between">
      <a role="button" class="">Linux</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/os/linux/linux-manual/" class="">Linux Manual</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-a437cea16383409ff4bb050630be8e13" class="toggle"  />
    <label for="section-a437cea16383409ff4bb050630be8e13" class="flex justify-between">
      <a role="button" class="">MAC Os</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-61556e42b41c13f33940b404f66932ed" class="toggle"  />
    <label for="section-61556e42b41c13f33940b404f66932ed" class="flex justify-between">
      <a role="button" class="">Terminal Command</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/os/mac-os/terminal-command/text-processing-and-searching/" class="">Text Processing and Searching</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-73eee81d29f3d1d06e3ced5db70613c1" class="toggle"  />
    <label for="section-73eee81d29f3d1d06e3ced5db70613c1" class="flex justify-between">
      <a role="button" class="">Web</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-a913ce247e99bf5334ae2e3cbeee0f90" class="toggle"  />
    <label for="section-a913ce247e99bf5334ae2e3cbeee0f90" class="flex justify-between">
      <a role="button" class="">Glossary</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web/glossary/cors/" class="">CORS</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-01867ca5de591b785e2c310209ee8cb4" class="toggle"  />
    <label for="section-01867ca5de591b785e2c310209ee8cb4" class="flex justify-between">
      <a role="button" class="">Web API</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web/web-api/web-storage-api/" class="">Web Storage Api</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-4da064fabd249335787f92ae73011b1b" class="toggle"  />
    <label for="section-4da064fabd249335787f92ae73011b1b" class="flex justify-between">
      <a role="button" class="">HTTP</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web/http/start-http/" class="">Start HTTP</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web/http/http-methods-and-status-codes/" class="">HTTP Methods &amp; Status Codes</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web/http/http-header-part-1/" class="">HTTP Headers: Part 1</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web/http/cookie/" class="">Cookie</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-6441cb17542fe8006e427b6b0a94d041" class="toggle"  />
    <label for="section-6441cb17542fe8006e427b6b0a94d041" class="flex justify-between">
      <a role="button" class="">Security</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web/security/asymmetric-encryption/" class="">Asymmetric Encryption</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web/security/session-vs-token/" class="">Session vs Token</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web/security/tls-handshake/" class="">TLS Handshake</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web/security/tls-handshake-client-hello/" class="">TLS Handshake: Client Hello</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web/security/tls-handshake-server-hello/" class="">TLS Handshake: Server Hello</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web/security/tls-handshake-certificate/" class="">TLS Handshake: Certificate</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web/security/tls-handshake-certificate-verify/" class="">TLS Handshake: Certificate Verify</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web/security/tls-handshake-certificate-finished/" class="">TLS Handshake: Finished</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-43effcc73883f6032917b714430cd064" class="toggle"  />
    <label for="section-43effcc73883f6032917b714430cd064" class="flex justify-between">
      <a role="button" class="">Tools</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-13ffff656c2dc3dfe4c18658b113a7be" class="toggle"  />
    <label for="section-13ffff656c2dc3dfe4c18658b113a7be" class="flex justify-between">
      <a role="button" class="">Hugo</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/tools/hugo/set-up-hugo-in-git-hub-pages/" class="">Set Up Hugo in Git Hub Pages</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-435c533cf8e83924f036a3fc06649777" class="toggle"  />
    <label for="section-435c533cf8e83924f036a3fc06649777" class="flex justify-between">
      <a role="button" class="">Aws</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/aws/cloudformation/" class="">CloudFormation</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-62258074df8a7a4253e368d8300827d8" class="toggle"  />
    <label for="section-62258074df8a7a4253e368d8300827d8" class="flex justify-between">
      <a role="button" class="">Message</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/aws/message/sns/" class="">SNS</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/aws/message/sqs/" class="">SQS</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/aws/message/eventbridge/" class="">EventBridge</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-5214fd1aa07e57317f87d16d6d714389" class="toggle"  />
    <label for="section-5214fd1aa07e57317f87d16d6d714389" class="flex justify-between">
      <a role="button" class="">Security</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/aws/security/kms/" class="">KMS</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-f08994ed3456b39a7f1229df10e15d9f" class="toggle"  />
    <label for="section-f08994ed3456b39a7f1229df10e15d9f" class="flex justify-between">
      <a role="button" class="">Network</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/network/dns/" class="">DNS</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/network/dns-hands-on/" class="">DNS Hands On</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/network/id-address/" class="">IP Address</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/network/cird/" class="">CIRD</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/network/subnet/" class="">Subnet</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-4634b8a2422e3042385f4c14a0822f58" class="toggle"  />
    <label for="section-4634b8a2422e3042385f4c14a0822f58" class="flex justify-between">
      <a role="button" class="">System Design</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-635ac14c32f4b096cb88b04c783b749f" class="toggle"  />
    <label for="section-635ac14c32f4b096cb88b04c783b749f" class="flex justify-between">
      <a role="button" class="">Design Data Intensive Applications</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/system-design/design-data-intensive-applications/replication/" class="">Replication</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/system-design/design-data-intensive-applications/partition/" class="">Partition</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/system-design/design-data-intensive-applications/transactions/" class="">Transactions</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-43f8309f7625d11a21842e4f1759c1f1" class="toggle"  />
    <label for="section-43f8309f7625d11a21842e4f1759c1f1" class="flex justify-between">
      <a role="button" class="">Load Balancing</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/system-design/load-balancing/load-balancer/" class="">Load Balancer</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-2a6004e8987d26d95ed1c07df5a63b81" class="toggle"  />
    <label for="section-2a6004e8987d26d95ed1c07df5a63b81" class="flex justify-between">
      <a role="button" class="">Haproxy</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/system-design/load-balancing/haproxy/get-start/" class="">HAProxy: Get Started</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/system-design/load-balancing/haproxy/health-check/" class="">HAProxy: Health Check</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/system-design/load-balancing/haproxy/load-balancing-algorithm/" class="">HAProxy: Load Balancing Algorithem</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/system-design/load-balancing/haproxy/layer7-load-balancing/" class="">HAProxy: HTTP (Layer 7) Load Balancing</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/system-design/load-balancing/haproxy/http-sticky-sessions-cookies/" class="">HAProxy: Sticky Sessions Using Cookies</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-d6b5a5ebe02e8f45cd65f61120086e8f" class="toggle"  />
    <label for="section-d6b5a5ebe02e8f45cd65f61120086e8f" class="flex justify-between">
      <a role="button" class="">Monitoring</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/system-design/monitoring/metric-log/" class="">Metric &amp; Log</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-5b4a6554295593bd19ab191ce0f0890a" class="toggle"  />
    <label for="section-5b4a6554295593bd19ab191ce0f0890a" class="flex justify-between">
      <a role="button" class="">Technology</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-e65dadec602a3e741624a6eace4b2779" class="toggle"  />
    <label for="section-e65dadec602a3e741624a6eace4b2779" class="flex justify-between">
      <a role="button" class="">Docker</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/system-design/technology/docker/docker-basics/" class="">Docker Basics</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-82f8da13d6fac792702112b64522aa5d" class="toggle"  />
    <label for="section-82f8da13d6fac792702112b64522aa5d" class="flex justify-between">
      <a role="button" class="">Redis</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/system-design/technology/redis/why-is-redis-so-fast/" class="">Why Is Redis So Fast</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/system-design/technology/redis/data-presistence/" class="">Data Persistence</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/system-design/technology/redis/pub-sub/" class="">Redis Pub/Sub</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/system-design/technology/redis/replication-and-sentinel/" class="">Redis Replication &amp; Sentinel</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>














</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <h3>Unblocking Mode</h3>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#unblocking-mode">Unblocking Mode</a>
      <ul>
        <li><a href="#code-example">Code Example</a></li>
        <li><a href="#demo">Demo</a>
          <ul>
            <li><a href="#start-the-server">Start the server</a></li>
            <li><a href="#client-connects-to-the-server">Client connects to the server</a></li>
            <li><a href="#client-sends-data-to-the-server">Client sends data to the server</a></li>
          </ul>
        </li>
        <li><a href="#summary">Summary</a></li>
      </ul>
    </li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown book-article"><h1 id="unblocking-mode">
  Unblocking Mode
  <a class="anchor" href="#unblocking-mode">#</a>
</h1>
<p>In last post, we discussed blocking mode and its problems. In this post, we will discuss unblocking mode and its problems</p>
<h2 id="code-example">
  Code Example
  <a class="anchor" href="#code-example">#</a>
</h2>
<ul>
<li>
<p>Server</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#a6e22e">@Slf4j</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Server</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String<span style="color:#f92672">[]</span> args) <span style="color:#66d9ef">throws</span> IOException {
</span></span><span style="display:flex;"><span>        ByteBuffer buffer <span style="color:#f92672">=</span> ByteBuffer.<span style="color:#a6e22e">allocate</span>(32);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        ServerSocketChannel ssc <span style="color:#f92672">=</span> ServerSocketChannel.<span style="color:#a6e22e">open</span>();
</span></span><span style="display:flex;"><span>        ssc.<span style="color:#a6e22e">bind</span>(<span style="color:#66d9ef">new</span> InetSocketAddress(9999));
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        ssc.<span style="color:#a6e22e">configureBlocking</span>(<span style="color:#66d9ef">false</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        List<span style="color:#f92672">&lt;</span>SocketChannel<span style="color:#f92672">&gt;</span> channels <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> (<span style="color:#66d9ef">true</span>) {
</span></span><span style="display:flex;"><span>            log.<span style="color:#a6e22e">debug</span>(<span style="color:#e6db74">&#34;Server connecting&#34;</span>);
</span></span><span style="display:flex;"><span>            SocketChannel sc <span style="color:#f92672">=</span> ssc.<span style="color:#a6e22e">accept</span>();
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> (sc <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span>) {
</span></span><span style="display:flex;"><span>                log.<span style="color:#a6e22e">debug</span>(<span style="color:#e6db74">&#34;Connect to client &#34;</span> <span style="color:#f92672">+</span> sc.<span style="color:#a6e22e">getRemoteAddress</span>());
</span></span><span style="display:flex;"><span>                sc.<span style="color:#a6e22e">configureBlocking</span>(<span style="color:#66d9ef">false</span>);
</span></span><span style="display:flex;"><span>                channels.<span style="color:#a6e22e">add</span>(sc);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (SocketChannel channel : channels) {
</span></span><span style="display:flex;"><span>                log.<span style="color:#a6e22e">debug</span>(<span style="color:#e6db74">&#34;Server reading&#34;</span>);
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">int</span> read <span style="color:#f92672">=</span> channel.<span style="color:#a6e22e">read</span>(buffer);
</span></span><span style="display:flex;"><span>                <span style="color:#66d9ef">if</span> (read <span style="color:#f92672">!=</span> 0) {
</span></span><span style="display:flex;"><span>                    buffer.<span style="color:#a6e22e">flip</span>();
</span></span><span style="display:flex;"><span>                    ByteBufferReader.<span style="color:#a6e22e">readAll</span>(buffer);
</span></span><span style="display:flex;"><span>                    buffer.<span style="color:#a6e22e">clear</span>();
</span></span><span style="display:flex;"><span>                    log.<span style="color:#a6e22e">debug</span>(<span style="color:#e6db74">&#34;Read data from client &#34;</span> <span style="color:#f92672">+</span> channel.<span style="color:#a6e22e">getRemoteAddress</span>());
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>Comparing with server code of blocking mode, we set blocking configuration of the <code>ServerSocketChannel</code> and <code>SocketChannel</code> to false
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span>ssc.<span style="color:#a6e22e">configureBlocking</span>(<span style="color:#66d9ef">false</span>);
</span></span><span style="display:flex;"><span>sc.<span style="color:#a6e22e">configureBlocking</span>(<span style="color:#66d9ef">false</span>);
</span></span></code></pre></div></li>
<li>Also we add a conditional check before adding the <code>SocketChannel</code> to the list and reading data from the channel. That is because in unblocking mode, method <code>scc.accept()</code> will not be blocked, instead it returns a <code>SocketChannel</code> object or <code>null</code> depending on if a client connects to the server. Hence, we should only add the <code>SocketChannel</code> to the list if it is not <code>null</code>, in other words, a client connects to the server.</li>
<li>Method <code>channel.read(buffer)</code> will always read from the <code>Channel</code> no matter clients send data or not. What the method returns is the length of bytes it reads. Here we only handle the data if <code>len &gt; 0</code>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (sc <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span>) {
</span></span><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> (read <span style="color:#f92672">!=</span> 0) {
</span></span><span style="display:flex;"><span>    ...
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div></li>
</ul>
</li>
<li>
<p>Client</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#a6e22e">@Slf4j</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Client</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String<span style="color:#f92672">[]</span> args) <span style="color:#66d9ef">throws</span> IOException {
</span></span><span style="display:flex;"><span>        SocketChannel sc <span style="color:#f92672">=</span> SocketChannel.<span style="color:#a6e22e">open</span>();
</span></span><span style="display:flex;"><span>        log.<span style="color:#a6e22e">debug</span>(<span style="color:#e6db74">&#34;Connecting to server&#34;</span>);
</span></span><span style="display:flex;"><span>        sc.<span style="color:#a6e22e">connect</span>(<span style="color:#66d9ef">new</span> InetSocketAddress(InetAddress.<span style="color:#a6e22e">getLocalHost</span>(), 9999));
</span></span><span style="display:flex;"><span>        log.<span style="color:#a6e22e">debug</span>(<span style="color:#e6db74">&#34;Connected with server&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> (<span style="color:#66d9ef">true</span>) {
</span></span><span style="display:flex;"><span>            String input <span style="color:#f92672">=</span> Scanner_.<span style="color:#a6e22e">scanLine</span>(<span style="color:#e6db74">&#34;Input: &#34;</span>);
</span></span><span style="display:flex;"><span>            log.<span style="color:#a6e22e">debug</span>(<span style="color:#e6db74">&#34;Sending data [{}] to server&#34;</span>, input);
</span></span><span style="display:flex;"><span>            sc.<span style="color:#a6e22e">write</span>(StandardCharsets.<span style="color:#a6e22e">UTF_8</span>.<span style="color:#a6e22e">encode</span>(input));
</span></span><span style="display:flex;"><span>            log.<span style="color:#a6e22e">debug</span>(<span style="color:#e6db74">&#34;Sent data [{}] to server&#34;</span>, input);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>Client code has no difference with that code in blocking mode</li>
</ul>
</li>
</ul>
<h2 id="demo">
  Demo
  <a class="anchor" href="#demo">#</a>
</h2>
<h3 id="start-the-server">
  Start the server
  <a class="anchor" href="#start-the-server">#</a>
</h3>
<ul>
<li>
<p>Server log:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>09:26:19.<span style="color:#a6e22e">287</span> <span style="color:#f92672">[</span>main<span style="color:#f92672">]</span> DEBUG com.<span style="color:#a6e22e">whatsbehind</span>.<span style="color:#a6e22e">netty_</span>.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">nonblocking</span>.<span style="color:#a6e22e">Server</span> <span style="color:#f92672">-</span> Server connecting
</span></span><span style="display:flex;"><span>09:26:19.<span style="color:#a6e22e">287</span> <span style="color:#f92672">[</span>main<span style="color:#f92672">]</span> DEBUG com.<span style="color:#a6e22e">whatsbehind</span>.<span style="color:#a6e22e">netty_</span>.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">nonblocking</span>.<span style="color:#a6e22e">Server</span> <span style="color:#f92672">-</span> Server connecting
</span></span><span style="display:flex;"><span>09:26:19.<span style="color:#a6e22e">287</span> <span style="color:#f92672">[</span>main<span style="color:#f92672">]</span> DEBUG com.<span style="color:#a6e22e">whatsbehind</span>.<span style="color:#a6e22e">netty_</span>.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">nonblocking</span>.<span style="color:#a6e22e">Server</span> <span style="color:#f92672">-</span> Server connecting
</span></span><span style="display:flex;"><span>09:26:19.<span style="color:#a6e22e">287</span> <span style="color:#f92672">[</span>main<span style="color:#f92672">]</span> DEBUG com.<span style="color:#a6e22e">whatsbehind</span>.<span style="color:#a6e22e">netty_</span>.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">nonblocking</span>.<span style="color:#a6e22e">Server</span> <span style="color:#f92672">-</span> Server connecting
</span></span><span style="display:flex;"><span>...
</span></span></code></pre></div><ul>
<li>The log <code>Server connecting</code> is printed infinitely because of unblocking mode</li>
</ul>
</li>
</ul>
<h3 id="client-connects-to-the-server">
  Client connects to the server
  <a class="anchor" href="#client-connects-to-the-server">#</a>
</h3>
<ul>
<li>
<p>Server log:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>09:28:40.<span style="color:#a6e22e">194</span> <span style="color:#f92672">[</span>main<span style="color:#f92672">]</span> DEBUG com.<span style="color:#a6e22e">whatsbehind</span>.<span style="color:#a6e22e">netty_</span>.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">nonblocking</span>.<span style="color:#a6e22e">Server</span> <span style="color:#f92672">-</span> Server connecting
</span></span><span style="display:flex;"><span>09:28:40.<span style="color:#a6e22e">194</span> <span style="color:#f92672">[</span>main<span style="color:#f92672">]</span> DEBUG com.<span style="color:#a6e22e">whatsbehind</span>.<span style="color:#a6e22e">netty_</span>.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">nonblocking</span>.<span style="color:#a6e22e">Server</span> <span style="color:#f92672">-</span> Server reading
</span></span><span style="display:flex;"><span>09:28:40.<span style="color:#a6e22e">194</span> <span style="color:#f92672">[</span>main<span style="color:#f92672">]</span> DEBUG com.<span style="color:#a6e22e">whatsbehind</span>.<span style="color:#a6e22e">netty_</span>.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">nonblocking</span>.<span style="color:#a6e22e">Server</span> <span style="color:#f92672">-</span> Server connecting
</span></span><span style="display:flex;"><span>09:28:40.<span style="color:#a6e22e">194</span> <span style="color:#f92672">[</span>main<span style="color:#f92672">]</span> DEBUG com.<span style="color:#a6e22e">whatsbehind</span>.<span style="color:#a6e22e">netty_</span>.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">nonblocking</span>.<span style="color:#a6e22e">Server</span> <span style="color:#f92672">-</span> Server reading
</span></span><span style="display:flex;"><span>09:28:40.<span style="color:#a6e22e">194</span> <span style="color:#f92672">[</span>main<span style="color:#f92672">]</span> DEBUG com.<span style="color:#a6e22e">whatsbehind</span>.<span style="color:#a6e22e">netty_</span>.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">nonblocking</span>.<span style="color:#a6e22e">Server</span> <span style="color:#f92672">-</span> Server connecting
</span></span><span style="display:flex;"><span>...
</span></span></code></pre></div><ul>
<li>Logs are continuously printed, but this time, new log <code>Server Reading</code> is printed also because after the client connects to the server, the <code>SocketChannel</code> is added in the list, and the server unblockingly reads the channel</li>
</ul>
</li>
<li>
<p>Client log:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span>09:28:33.<span style="color:#a6e22e">989</span> <span style="color:#f92672">[</span>main<span style="color:#f92672">]</span> DEBUG com.<span style="color:#a6e22e">whatsbehind</span>.<span style="color:#a6e22e">netty_</span>.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">nonblocking</span>.<span style="color:#a6e22e">Client</span> <span style="color:#f92672">-</span> Connecting to server
</span></span><span style="display:flex;"><span>09:28:33.<span style="color:#a6e22e">993</span> <span style="color:#f92672">[</span>main<span style="color:#f92672">]</span> DEBUG com.<span style="color:#a6e22e">whatsbehind</span>.<span style="color:#a6e22e">netty_</span>.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">nonblocking</span>.<span style="color:#a6e22e">Client</span> <span style="color:#f92672">-</span> Connected with server
</span></span><span style="display:flex;"><span>Input: 
</span></span></code></pre></div></li>
</ul>
<h3 id="client-sends-data-to-the-server">
  Client sends data to the server
  <a class="anchor" href="#client-sends-data-to-the-server">#</a>
</h3>
<p>To better demonstrate unblocking mode, I removed some logs in the server code to avoid logs from continuously being printed. Then I restarted the server, and connects to the client</p>
<ul>
<li>
<p>Client log:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span>09:40:28.<span style="color:#a6e22e">973</span> <span style="color:#f92672">[</span>main<span style="color:#f92672">]</span> DEBUG com.<span style="color:#a6e22e">whatsbehind</span>.<span style="color:#a6e22e">netty_</span>.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">nonblocking</span>.<span style="color:#a6e22e">Client</span> <span style="color:#f92672">-</span> Connecting to server
</span></span><span style="display:flex;"><span>09:40:28.<span style="color:#a6e22e">976</span> <span style="color:#f92672">[</span>main<span style="color:#f92672">]</span> DEBUG com.<span style="color:#a6e22e">whatsbehind</span>.<span style="color:#a6e22e">netty_</span>.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">nonblocking</span>.<span style="color:#a6e22e">Client</span> <span style="color:#f92672">-</span> Connected with server
</span></span><span style="display:flex;"><span>Input: Hello Server from ClientA<span style="color:#f92672">!</span>
</span></span><span style="display:flex;"><span>09:40:45.<span style="color:#a6e22e">721</span> <span style="color:#f92672">[</span>main<span style="color:#f92672">]</span> DEBUG com.<span style="color:#a6e22e">whatsbehind</span>.<span style="color:#a6e22e">netty_</span>.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">nonblocking</span>.<span style="color:#a6e22e">Client</span> <span style="color:#f92672">-</span> Sending data <span style="color:#f92672">[</span>Hello Server from ClientA<span style="color:#f92672">!]</span> to server
</span></span><span style="display:flex;"><span>09:40:45.<span style="color:#a6e22e">722</span> <span style="color:#f92672">[</span>main<span style="color:#f92672">]</span> DEBUG com.<span style="color:#a6e22e">whatsbehind</span>.<span style="color:#a6e22e">netty_</span>.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">nonblocking</span>.<span style="color:#a6e22e">Client</span> <span style="color:#f92672">-</span> Sent data <span style="color:#f92672">[</span>Hello Server from ClientA<span style="color:#f92672">!]</span> to server
</span></span><span style="display:flex;"><span>Input: Hello Server from ClientA Again<span style="color:#f92672">!</span>
</span></span><span style="display:flex;"><span>09:40:57.<span style="color:#a6e22e">604</span> <span style="color:#f92672">[</span>main<span style="color:#f92672">]</span> DEBUG com.<span style="color:#a6e22e">whatsbehind</span>.<span style="color:#a6e22e">netty_</span>.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">nonblocking</span>.<span style="color:#a6e22e">Client</span> <span style="color:#f92672">-</span> Sending data <span style="color:#f92672">[</span>Hello Server from ClientA Again<span style="color:#f92672">!]</span> to server
</span></span><span style="display:flex;"><span>09:40:57.<span style="color:#a6e22e">605</span> <span style="color:#f92672">[</span>main<span style="color:#f92672">]</span> DEBUG com.<span style="color:#a6e22e">whatsbehind</span>.<span style="color:#a6e22e">netty_</span>.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">nonblocking</span>.<span style="color:#a6e22e">Client</span> <span style="color:#f92672">-</span> Sent data <span style="color:#f92672">[</span>Hello Server from ClientA Again<span style="color:#f92672">!]</span> to server
</span></span><span style="display:flex;"><span>Input: 
</span></span></code></pre></div><ul>
<li>A client connects to the server and sends two strings to the server. In blocking mode, the server should only receive first string and receive second string until another client connects to the server</li>
</ul>
</li>
<li>
<p>Server log</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span>09:40:28.<span style="color:#a6e22e">989</span> <span style="color:#f92672">[</span>main<span style="color:#f92672">]</span> DEBUG com.<span style="color:#a6e22e">whatsbehind</span>.<span style="color:#a6e22e">netty_</span>.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">nonblocking</span>.<span style="color:#a6e22e">Server</span> <span style="color:#f92672">-</span> Connect to client <span style="color:#f92672">/</span>127.<span style="color:#a6e22e">0</span>.<span style="color:#a6e22e">0</span>.<span style="color:#a6e22e">1</span>:50930
</span></span><span style="display:flex;"><span>09:40:45.<span style="color:#a6e22e">723</span> <span style="color:#f92672">[</span>main<span style="color:#f92672">]</span> DEBUG com.<span style="color:#a6e22e">whatsbehind</span>.<span style="color:#a6e22e">netty_</span>.<span style="color:#a6e22e">utility</span>.<span style="color:#a6e22e">ByteBufferReader</span> <span style="color:#f92672">-</span> Hello Server from ClientA<span style="color:#f92672">!</span>
</span></span><span style="display:flex;"><span>09:40:45.<span style="color:#a6e22e">723</span> <span style="color:#f92672">[</span>main<span style="color:#f92672">]</span> DEBUG com.<span style="color:#a6e22e">whatsbehind</span>.<span style="color:#a6e22e">netty_</span>.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">nonblocking</span>.<span style="color:#a6e22e">Server</span> <span style="color:#f92672">-</span> Read data from client <span style="color:#f92672">/</span>127.<span style="color:#a6e22e">0</span>.<span style="color:#a6e22e">0</span>.<span style="color:#a6e22e">1</span>:50930
</span></span><span style="display:flex;"><span>09:40:57.<span style="color:#a6e22e">605</span> <span style="color:#f92672">[</span>main<span style="color:#f92672">]</span> DEBUG com.<span style="color:#a6e22e">whatsbehind</span>.<span style="color:#a6e22e">netty_</span>.<span style="color:#a6e22e">utility</span>.<span style="color:#a6e22e">ByteBufferReader</span> <span style="color:#f92672">-</span> Hello Server from ClientA Again<span style="color:#f92672">!</span>
</span></span><span style="display:flex;"><span>09:40:57.<span style="color:#a6e22e">605</span> <span style="color:#f92672">[</span>main<span style="color:#f92672">]</span> DEBUG com.<span style="color:#a6e22e">whatsbehind</span>.<span style="color:#a6e22e">netty_</span>.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">nonblocking</span>.<span style="color:#a6e22e">Server</span> <span style="color:#f92672">-</span> Read data from client <span style="color:#f92672">/</span>127.<span style="color:#a6e22e">0</span>.<span style="color:#a6e22e">0</span>.<span style="color:#a6e22e">1</span>:50930
</span></span></code></pre></div><ul>
<li>The server connects to the client</li>
<li>Further more, it receives all strings from the client. As we can see here, because the server is running in unblocking mode, it can handle client connection and data communication concurrently</li>
</ul>
</li>
</ul>
<h2 id="summary">
  Summary
  <a class="anchor" href="#summary">#</a>
</h2>
<ul>
<li>In unblocking mode, the blocking methods get executed, so the server can handle multiple connections and receive data from multiple clients concurrently.</li>
<li>However, different from blocking mode in which the CPU is blocked for most time, CPU in unblocking mode is busy and always running. That&rsquo;s the problem of unblocking mode and it is a waste of resource cause in most time, CPU doesn&rsquo;t do any useful work but run the while loop&hellip;</li>
<li>In the next post, we will discuss how NIO uses <code>Selector</code> to handle this issue</li>
</ul>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>



  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#unblocking-mode">Unblocking Mode</a>
      <ul>
        <li><a href="#code-example">Code Example</a></li>
        <li><a href="#demo">Demo</a>
          <ul>
            <li><a href="#start-the-server">Start the server</a></li>
            <li><a href="#client-connects-to-the-server">Client connects to the server</a></li>
            <li><a href="#client-sends-data-to-the-server">Client sends data to the server</a></li>
          </ul>
        </li>
        <li><a href="#summary">Summary</a></li>
      </ul>
    </li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












