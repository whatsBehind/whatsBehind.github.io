<!DOCTYPE html>
<html lang="en-us" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Blocking Mode # This post will introduce the blocking mode of network connection and communication in Java code. We will first wirte both server and client codes. Then demo the blocking mode and its problems.
Code Example # Server
@Slf4j public class Server { public static void main(String[] args) throws IOException { ByteBuffer buffer = ByteBuffer.allocate(32); // Create server ServerSocketChannel ssc = ServerSocketChannel.open(); // Server listens to port 9999 at local host ssc.">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:title" content="Blocking Mode" />
<meta property="og:description" content="Blocking Mode # This post will introduce the blocking mode of network connection and communication in Java code. We will first wirte both server and client codes. Then demo the blocking mode and its problems.
Code Example # Server
@Slf4j public class Server { public static void main(String[] args) throws IOException { ByteBuffer buffer = ByteBuffer.allocate(32); // Create server ServerSocketChannel ssc = ServerSocketChannel.open(); // Server listens to port 9999 at local host ssc." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://whatsBehind.github.io/docs/programming/backend/java/netty/blocking-mode/" /><meta property="article:section" content="docs" />



<title>Blocking Mode | What&#39;s Behind</title>
<link rel="manifest" href="/manifest.json">
<link rel="icon" href="/favicon.png" >
<link rel="stylesheet" href="/book.min.33a48f5432973b8ff9a82679d9e45d67f2c15d4399bd2829269455cfe390b5e8.css" integrity="sha256-M6SPVDKXO4/5qCZ52eRdZ/LBXUOZvSgpJpRVz&#43;OQteg=" crossorigin="anonymous">
  <script defer src="/flexsearch.min.js"></script>
  <script defer src="/en.search.min.c1ec51c640c2b6511ce29c7448a1f23f200d8ba3eb2109a70a0bf715fd00d1ec.js" integrity="sha256-wexRxkDCtlEc4px0SKHyPyANi6PrIQmnCgv3Ff0A0ew=" crossorigin="anonymous"></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><span>What&#39;s Behind</span>
  </a>
</h2>


<div class="book-search">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>












  



  
  <ul>
    
      
        <li>
          
  
  

  
    <span>Programming</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-7ce6fe0c65f837fcf676f1e6ecbf9947" class="toggle"  />
    <label for="section-7ce6fe0c65f837fcf676f1e6ecbf9947" class="flex justify-between">
      <a role="button" class="">Project</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/project/online-chat/" class="">Online Chat</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-7844d228e6c88ae97cf5828b0d009769" class="toggle" checked />
    <label for="section-7844d228e6c88ae97cf5828b0d009769" class="flex justify-between">
      <a role="button" class="">Backend</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-85e6d0a84cbb2566773c803dc893e0af" class="toggle" checked />
    <label for="section-85e6d0a84cbb2566773c803dc893e0af" class="flex justify-between">
      <a role="button" class="">Java</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-4d132fa86c191d313485f304ca9a1229" class="toggle"  />
    <label for="section-4d132fa86c191d313485f304ca9a1229" class="flex justify-between">
      <a role="button" class="">Net</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/net/tcp-socket/" class="">Tcp Socket</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-f8771c290018cde58e0ed5c89ae77e0d" class="toggle"  />
    <label for="section-f8771c290018cde58e0ed5c89ae77e0d" class="flex justify-between">
      <a role="button" class="">Io</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/io/decorator-pattern-in-java-io/" class="">Decorator Pattern in Java IO</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/io/object-input-and-output-stream/" class="">ObjectInputStream and ObjectOutputStream</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/io/stream-reader-bridge-of-byte-and-char/" class="">Stream Reader: Bridge of Byte and Char</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/io/io-stream/" class="">Java IO Stream</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/io/file/" class="">Java File</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-51b21b1aa4706431f75da30c83254b65" class="toggle"  />
    <label for="section-51b21b1aa4706431f75da30c83254b65" class="flex justify-between">
      <a role="button" class="">Thread</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/thread/synchornization/" class="">Synchornization</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/thread/thread-lifecycle/" class="">Thread Lifecycle</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/thread/start-thread/" class="">Start Thread</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/reflection/" class="">Reflection</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-945932e727978560611817848680d393" class="toggle" checked />
    <label for="section-945932e727978560611817848680d393" class="flex justify-between">
      <a role="button" class="">Netty</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/netty/byte-buffer/" class="">Byte Buffer</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/netty/blocking-mode/" class="active">Blocking Mode</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/netty/unblocking-mode/" class="">Unblocking Mode</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-3fb923816a079b91d0045c2bbe184452" class="toggle"  />
    <label for="section-3fb923816a079b91d0045c2bbe184452" class="flex justify-between">
      <a role="button" class="">Os</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-eef785d90f032562151b69894191310f" class="toggle"  />
    <label for="section-eef785d90f032562151b69894191310f" class="flex justify-between">
      <a role="button" class="">Linux</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/os/linux/linux-manual/" class="">Linux Manual</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-baafd18a53132bc7da781d43371b88b2" class="toggle"  />
    <label for="section-baafd18a53132bc7da781d43371b88b2" class="flex justify-between">
      <a role="button" class="">Web</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-eee032ba51521b5a76ca688aa982a5cd" class="toggle"  />
    <label for="section-eee032ba51521b5a76ca688aa982a5cd" class="flex justify-between">
      <a role="button" class="">Glossary</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web/glossary/cors/" class="">CORS</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-c0de0223513b5941f61c65ed294def20" class="toggle"  />
    <label for="section-c0de0223513b5941f61c65ed294def20" class="flex justify-between">
      <a role="button" class="">Web API</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web/web-api/web-storage-api/" class="">Web Storage Api</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-0975d481e131cd3566df9e7779add732" class="toggle"  />
    <label for="section-0975d481e131cd3566df9e7779add732" class="flex justify-between">
      <a role="button" class="">HTTP</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web/http/cookie/" class="">Cookie</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-c91ba5e94a01028927e7fe8e471dfed6" class="toggle"  />
    <label for="section-c91ba5e94a01028927e7fe8e471dfed6" class="flex justify-between">
      <a role="button" class="">Tools</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-61b4842f6a6edc0699378637391b21b9" class="toggle"  />
    <label for="section-61b4842f6a6edc0699378637391b21b9" class="flex justify-between">
      <a role="button" class="">Hugo</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/tools/hugo/set-up-hugo-in-git-hub-pages/" class="">Set Up Hugo in Git Hub Pages</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-2d83032c16586068a0402c6767f2442f" class="toggle"  />
    <label for="section-2d83032c16586068a0402c6767f2442f" class="flex justify-between">
      <a role="button" class="">Network</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-a047c0faadc787118d3878bd75e8b987" class="toggle"  />
    <label for="section-a047c0faadc787118d3878bd75e8b987" class="flex justify-between">
      <a role="button" class="">Note</a>
    </label>
  

          
  <ul>
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>















</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <strong>Blocking Mode</strong>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#code-example">Code Example</a></li>
    <li><a href="#demo">Demo</a>
      <ul>
        <li><a href="#start-the-server">Start the server</a></li>
        <li><a href="#start-clienta">Start clientA</a></li>
        <li><a href="#send-data-from-clienta-to-the-server">Send data from clientA to the server</a></li>
        <li><a href="#send-data-again-from-clienta-to-the-server">Send data again from clientA to the server</a></li>
        <li><a href="#clientb-connects-to-the-server">ClientB connects to the server</a></li>
      </ul>
    </li>
    <li><a href="#summary">Summary</a></li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown book-article"><h1 id="blocking-mode">
  Blocking Mode
  <a class="anchor" href="#blocking-mode">#</a>
</h1>
<p>This post will introduce the blocking mode of network connection and communication in Java code. We will first wirte both server and client codes. Then demo the blocking mode and its problems.</p>
<h2 id="code-example">
  Code Example
  <a class="anchor" href="#code-example">#</a>
</h2>
<ul>
<li>
<p>Server</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#a6e22e">@Slf4j</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Server</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String<span style="color:#f92672">[]</span> args) <span style="color:#66d9ef">throws</span> IOException {
</span></span><span style="display:flex;"><span>        ByteBuffer buffer <span style="color:#f92672">=</span> ByteBuffer.<span style="color:#a6e22e">allocate</span>(32);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Create server</span>
</span></span><span style="display:flex;"><span>        ServerSocketChannel ssc <span style="color:#f92672">=</span> ServerSocketChannel.<span style="color:#a6e22e">open</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Server listens to port 9999 at local host</span>
</span></span><span style="display:flex;"><span>        ssc.<span style="color:#a6e22e">bind</span>(<span style="color:#66d9ef">new</span> InetSocketAddress(9999));
</span></span><span style="display:flex;"><span>        log.<span style="color:#a6e22e">debug</span>(<span style="color:#e6db74">&#34;Create server listening to port 9999&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        List<span style="color:#f92672">&lt;</span>SocketChannel<span style="color:#f92672">&gt;</span> socketChannels <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;</span>();
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> (<span style="color:#66d9ef">true</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// Accept: build connection with client</span>
</span></span><span style="display:flex;"><span>            log.<span style="color:#a6e22e">debug</span>(<span style="color:#e6db74">&#34;Waiting for client connection...&#34;</span>);
</span></span><span style="display:flex;"><span>            SocketChannel socketChannel <span style="color:#f92672">=</span> ssc.<span style="color:#a6e22e">accept</span>();
</span></span><span style="display:flex;"><span>            log.<span style="color:#a6e22e">debug</span>(<span style="color:#e6db74">&#34;Build connection with client &#34;</span> <span style="color:#f92672">+</span> socketChannel.<span style="color:#a6e22e">getRemoteAddress</span>());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// Add socketChannel to a list</span>
</span></span><span style="display:flex;"><span>            socketChannels.<span style="color:#a6e22e">add</span>(socketChannel);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// Iterate all SocketChannels and read data from channel and write it to the ByteBuffer</span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">for</span> (SocketChannel channel : socketChannels) {
</span></span><span style="display:flex;"><span>                log.<span style="color:#a6e22e">debug</span>(<span style="color:#e6db74">&#34;Start to read channel from client &#34;</span> <span style="color:#f92672">+</span> channel.<span style="color:#a6e22e">getRemoteAddress</span>());
</span></span><span style="display:flex;"><span>                channel.<span style="color:#a6e22e">read</span>(buffer);
</span></span><span style="display:flex;"><span>                buffer.<span style="color:#a6e22e">flip</span>();
</span></span><span style="display:flex;"><span>                ByteBufferReader.<span style="color:#a6e22e">readAll</span>(buffer);
</span></span><span style="display:flex;"><span>                buffer.<span style="color:#a6e22e">clear</span>();
</span></span><span style="display:flex;"><span>                log.<span style="color:#a6e22e">debug</span>(<span style="color:#e6db74">&#34;Complete reading data&#34;</span>);
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>This is code for the server. First we create a <code>ServerSocketChannel</code> listens to port <code>9999</code> of local host</li>
<li>We have an infinite while loop where the server accepts connection from clients. Once connection is built, the server creates a new <code>SocketChannel</code> and add it into a list</li>
<li>After connection is built, we iterate collection of all <code>SocketChannel</code>, and read data from the channel and write it to a <code>ByteBuffer</code></li>
</ul>
<p>In the server code above, we add multiple logs before and after client connection and reading data from the channel to better demonstrate blocking mode.</p>
</li>
<li>
<p>Client</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#a6e22e">@Slf4j</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Client</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>(String<span style="color:#f92672">[]</span> args) <span style="color:#66d9ef">throws</span> IOException {
</span></span><span style="display:flex;"><span>        SocketChannel sc <span style="color:#f92672">=</span> SocketChannel.<span style="color:#a6e22e">open</span>();
</span></span><span style="display:flex;"><span>        log.<span style="color:#a6e22e">debug</span>(<span style="color:#e6db74">&#34;Connecting to server&#34;</span>);
</span></span><span style="display:flex;"><span>        sc.<span style="color:#a6e22e">connect</span>(<span style="color:#66d9ef">new</span> InetSocketAddress(InetAddress.<span style="color:#a6e22e">getLocalHost</span>(), 9999));
</span></span><span style="display:flex;"><span>        log.<span style="color:#a6e22e">debug</span>(<span style="color:#e6db74">&#34;Connected with server&#34;</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">while</span> (<span style="color:#66d9ef">true</span>) {
</span></span><span style="display:flex;"><span>            String input <span style="color:#f92672">=</span> Scanner_.<span style="color:#a6e22e">scanLine</span>(<span style="color:#e6db74">&#34;Input: &#34;</span>);
</span></span><span style="display:flex;"><span>            log.<span style="color:#a6e22e">debug</span>(<span style="color:#e6db74">&#34;Sending data [{}] to server&#34;</span>, input);
</span></span><span style="display:flex;"><span>            sc.<span style="color:#a6e22e">write</span>(StandardCharsets.<span style="color:#a6e22e">UTF_8</span>.<span style="color:#a6e22e">encode</span>(input));
</span></span><span style="display:flex;"><span>            log.<span style="color:#a6e22e">debug</span>(<span style="color:#e6db74">&#34;Sent data [{}] to server&#34;</span>, input);
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><ul>
<li>In client&rsquo;s code, we connect to the server</li>
<li>Then in a while loop, we scan input from terminal and send the data to the server</li>
</ul>
<p>Same as server&rsquo;s code, we add some logs</p>
</li>
</ul>
<h2 id="demo">
  Demo
  <a class="anchor" href="#demo">#</a>
</h2>
<h3 id="start-the-server">
  Start the server
  <a class="anchor" href="#start-the-server">#</a>
</h3>
<ul>
<li>
<p>Server log:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span>20:29:52.<span style="color:#a6e22e">904</span> <span style="color:#f92672">[</span>main<span style="color:#f92672">]</span> DEBUG com.<span style="color:#a6e22e">whatsbehind</span>.<span style="color:#a6e22e">netty_</span>.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">blocking</span>.<span style="color:#a6e22e">Server</span> <span style="color:#f92672">-</span> Create server listening to port 9999
</span></span><span style="display:flex;"><span>20:29:52.<span style="color:#a6e22e">906</span> <span style="color:#f92672">[</span>main<span style="color:#f92672">]</span> DEBUG com.<span style="color:#a6e22e">whatsbehind</span>.<span style="color:#a6e22e">netty_</span>.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">blocking</span>.<span style="color:#a6e22e">Server</span> <span style="color:#f92672">-</span> Waiting <span style="color:#66d9ef">for</span> client connection...
</span></span></code></pre></div><ul>
<li>We start a server, and server is blocked until a client connects to the server. This is the first blocking place in the server code.
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span>SocketChannel socketChannel <span style="color:#f92672">=</span> ssc.<span style="color:#a6e22e">accept</span>();
</span></span></code></pre></div></li>
</ul>
</li>
</ul>
<h3 id="start-clienta">
  Start clientA
  <a class="anchor" href="#start-clienta">#</a>
</h3>
<ul>
<li>
<p>Server log:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span>20:33:01.<span style="color:#a6e22e">791</span> <span style="color:#f92672">[</span>main<span style="color:#f92672">]</span> DEBUG com.<span style="color:#a6e22e">whatsbehind</span>.<span style="color:#a6e22e">netty_</span>.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">blocking</span>.<span style="color:#a6e22e">Server</span> <span style="color:#f92672">-</span> Build connection with client <span style="color:#f92672">/</span>127.<span style="color:#a6e22e">0</span>.<span style="color:#a6e22e">0</span>.<span style="color:#a6e22e">1</span>:50632
</span></span><span style="display:flex;"><span>20:33:01.<span style="color:#a6e22e">791</span> <span style="color:#f92672">[</span>main<span style="color:#f92672">]</span> DEBUG com.<span style="color:#a6e22e">whatsbehind</span>.<span style="color:#a6e22e">netty_</span>.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">blocking</span>.<span style="color:#a6e22e">Server</span> <span style="color:#f92672">-</span> Start to read channel from client <span style="color:#f92672">/</span>127.<span style="color:#a6e22e">0</span>.<span style="color:#a6e22e">0</span>.<span style="color:#a6e22e">1</span>:50632
</span></span></code></pre></div><ul>
<li>
<p>Client of port(50632) connects to the server</p>
</li>
<li>
<p>Server code is blocked again until recevies any data from clientA</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span>channel.<span style="color:#a6e22e">read</span>(buffer);
</span></span></code></pre></div></li>
</ul>
</li>
<li>
<p>ClientA log:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span>20:33:01.<span style="color:#a6e22e">777</span> <span style="color:#f92672">[</span>main<span style="color:#f92672">]</span> DEBUG com.<span style="color:#a6e22e">whatsbehind</span>.<span style="color:#a6e22e">netty_</span>.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">blocking</span>.<span style="color:#a6e22e">Client</span> <span style="color:#f92672">-</span> Connecting to server
</span></span><span style="display:flex;"><span>20:33:01.<span style="color:#a6e22e">780</span> <span style="color:#f92672">[</span>main<span style="color:#f92672">]</span> DEBUG com.<span style="color:#a6e22e">whatsbehind</span>.<span style="color:#a6e22e">netty_</span>.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">blocking</span>.<span style="color:#a6e22e">Client</span> <span style="color:#f92672">-</span> Connected with server
</span></span><span style="display:flex;"><span>Input: 
</span></span></code></pre></div><ul>
<li>ClientA conects to the server and waiting for user to type in the terminal</li>
</ul>
</li>
</ul>
<h3 id="send-data-from-clienta-to-the-server">
  Send data from clientA to the server
  <a class="anchor" href="#send-data-from-clienta-to-the-server">#</a>
</h3>
<ul>
<li>
<p>ClientA log:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span>Input: Hello Server from ClientA<span style="color:#f92672">!</span>
</span></span><span style="display:flex;"><span>20:38:02.<span style="color:#a6e22e">356</span> <span style="color:#f92672">[</span>main<span style="color:#f92672">]</span> DEBUG com.<span style="color:#a6e22e">whatsbehind</span>.<span style="color:#a6e22e">netty_</span>.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">blocking</span>.<span style="color:#a6e22e">Client</span> <span style="color:#f92672">-</span> Sending data <span style="color:#f92672">[</span>Hello Server from ClientA<span style="color:#f92672">!]</span> to server
</span></span><span style="display:flex;"><span>20:38:02.<span style="color:#a6e22e">358</span> <span style="color:#f92672">[</span>main<span style="color:#f92672">]</span> DEBUG com.<span style="color:#a6e22e">whatsbehind</span>.<span style="color:#a6e22e">netty_</span>.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">blocking</span>.<span style="color:#a6e22e">Client</span> <span style="color:#f92672">-</span> Sent data <span style="color:#f92672">[</span>Hello Server from ClientA<span style="color:#f92672">!]</span> to server
</span></span><span style="display:flex;"><span>Input: 
</span></span></code></pre></div><ul>
<li>In clientA, we typed <code>Hello Server from ClientA!</code>. After hitting <code>Enter</code> key, the string we just typed was sent to the server.</li>
</ul>
</li>
<li>
<p>Server log:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span>20:38:02.<span style="color:#a6e22e">358</span> <span style="color:#f92672">[</span>main<span style="color:#f92672">]</span> DEBUG com.<span style="color:#a6e22e">whatsbehind</span>.<span style="color:#a6e22e">netty_</span>.<span style="color:#a6e22e">utility</span>.<span style="color:#a6e22e">ByteBufferReader</span> <span style="color:#f92672">-</span> Hello Server from ClientA<span style="color:#f92672">!</span>
</span></span><span style="display:flex;"><span>20:38:02.<span style="color:#a6e22e">359</span> <span style="color:#f92672">[</span>main<span style="color:#f92672">]</span> DEBUG com.<span style="color:#a6e22e">whatsbehind</span>.<span style="color:#a6e22e">netty_</span>.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">blocking</span>.<span style="color:#a6e22e">Server</span> <span style="color:#f92672">-</span> Complete reading data
</span></span><span style="display:flex;"><span>20:38:02.<span style="color:#a6e22e">359</span> <span style="color:#f92672">[</span>main<span style="color:#f92672">]</span> DEBUG com.<span style="color:#a6e22e">whatsbehind</span>.<span style="color:#a6e22e">netty_</span>.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">blocking</span>.<span style="color:#a6e22e">Server</span> <span style="color:#f92672">-</span> Waiting <span style="color:#66d9ef">for</span> client connection...
</span></span></code></pre></div><ul>
<li>Server receives the string <code>Hello Server from ClientA!</code>, and prints the string in the terminal</li>
<li>Server is not blocked at reading data from channel, and code is executed again</li>
<li>Server is blocked at waiting for connection from another client</li>
</ul>
</li>
</ul>
<h3 id="send-data-again-from-clienta-to-the-server">
  Send data again from clientA to the server
  <a class="anchor" href="#send-data-again-from-clienta-to-the-server">#</a>
</h3>
<ul>
<li>
<p>ClientA log:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span>Input: Hello Server from ClientA Again<span style="color:#f92672">!</span>
</span></span><span style="display:flex;"><span>20:42:28.<span style="color:#a6e22e">083</span> <span style="color:#f92672">[</span>main<span style="color:#f92672">]</span> DEBUG com.<span style="color:#a6e22e">whatsbehind</span>.<span style="color:#a6e22e">netty_</span>.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">blocking</span>.<span style="color:#a6e22e">Client</span> <span style="color:#f92672">-</span> Sending data <span style="color:#f92672">[</span>Hello Server from ClientA Again<span style="color:#f92672">!]</span> to server
</span></span><span style="display:flex;"><span>20:42:28.<span style="color:#a6e22e">084</span> <span style="color:#f92672">[</span>main<span style="color:#f92672">]</span> DEBUG com.<span style="color:#a6e22e">whatsbehind</span>.<span style="color:#a6e22e">netty_</span>.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">blocking</span>.<span style="color:#a6e22e">Client</span> <span style="color:#f92672">-</span> Sent data <span style="color:#f92672">[</span>Hello Server from ClientA Again<span style="color:#f92672">!]</span> to server
</span></span><span style="display:flex;"><span>Input: 
</span></span></code></pre></div><ul>
<li>ClientA sends a new string <code>Hello Server from ClientA Again!</code> to the server</li>
</ul>
</li>
<li>
<p>Server</p>
<ul>
<li>Server doesn&rsquo;t have any new logs printed. Because it was blocked at waiting for client connection, no matter how much data sent from clientA, it won&rsquo;t be handled by the server</li>
</ul>
</li>
</ul>
<h3 id="clientb-connects-to-the-server">
  ClientB connects to the server
  <a class="anchor" href="#clientb-connects-to-the-server">#</a>
</h3>
<ul>
<li>
<p>Client B log:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span>20:45:17.<span style="color:#a6e22e">107</span> <span style="color:#f92672">[</span>main<span style="color:#f92672">]</span> DEBUG com.<span style="color:#a6e22e">whatsbehind</span>.<span style="color:#a6e22e">netty_</span>.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">blocking</span>.<span style="color:#a6e22e">Client</span> <span style="color:#f92672">-</span> Connecting to server
</span></span><span style="display:flex;"><span>20:45:17.<span style="color:#a6e22e">111</span> <span style="color:#f92672">[</span>main<span style="color:#f92672">]</span> DEBUG com.<span style="color:#a6e22e">whatsbehind</span>.<span style="color:#a6e22e">netty_</span>.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">blocking</span>.<span style="color:#a6e22e">Client</span> <span style="color:#f92672">-</span> Connected with server
</span></span><span style="display:flex;"><span>Input: 
</span></span></code></pre></div><ul>
<li>A new clientB connects to the server</li>
</ul>
</li>
<li>
<p>Server log:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span>20:45:17.<span style="color:#a6e22e">111</span> <span style="color:#f92672">[</span>main<span style="color:#f92672">]</span> DEBUG com.<span style="color:#a6e22e">whatsbehind</span>.<span style="color:#a6e22e">netty_</span>.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">blocking</span>.<span style="color:#a6e22e">Server</span> <span style="color:#f92672">-</span> Build connection with client <span style="color:#f92672">/</span>127.<span style="color:#a6e22e">0</span>.<span style="color:#a6e22e">0</span>.<span style="color:#a6e22e">1</span>:50698
</span></span><span style="display:flex;"><span>20:45:17.<span style="color:#a6e22e">111</span> <span style="color:#f92672">[</span>main<span style="color:#f92672">]</span> DEBUG com.<span style="color:#a6e22e">whatsbehind</span>.<span style="color:#a6e22e">netty_</span>.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">blocking</span>.<span style="color:#a6e22e">Server</span> <span style="color:#f92672">-</span> Start to read channel from client <span style="color:#f92672">/</span>127.<span style="color:#a6e22e">0</span>.<span style="color:#a6e22e">0</span>.<span style="color:#a6e22e">1</span>:50632
</span></span><span style="display:flex;"><span>20:45:17.<span style="color:#a6e22e">111</span> <span style="color:#f92672">[</span>main<span style="color:#f92672">]</span> DEBUG com.<span style="color:#a6e22e">whatsbehind</span>.<span style="color:#a6e22e">netty_</span>.<span style="color:#a6e22e">utility</span>.<span style="color:#a6e22e">ByteBufferReader</span> <span style="color:#f92672">-</span> Hello Server from ClientA Again<span style="color:#f92672">!</span>
</span></span><span style="display:flex;"><span>20:45:17.<span style="color:#a6e22e">111</span> <span style="color:#f92672">[</span>main<span style="color:#f92672">]</span> DEBUG com.<span style="color:#a6e22e">whatsbehind</span>.<span style="color:#a6e22e">netty_</span>.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">blocking</span>.<span style="color:#a6e22e">Server</span> <span style="color:#f92672">-</span> Complete reading data
</span></span><span style="display:flex;"><span>20:45:17.<span style="color:#a6e22e">111</span> <span style="color:#f92672">[</span>main<span style="color:#f92672">]</span> DEBUG com.<span style="color:#a6e22e">whatsbehind</span>.<span style="color:#a6e22e">netty_</span>.<span style="color:#a6e22e">nio</span>.<span style="color:#a6e22e">blocking</span>.<span style="color:#a6e22e">Server</span> <span style="color:#f92672">-</span> Start to read channel from client <span style="color:#f92672">/</span>127.<span style="color:#a6e22e">0</span>.<span style="color:#a6e22e">0</span>.<span style="color:#a6e22e">1</span>:50698
</span></span></code></pre></div><ul>
<li>ClientB from port(50698) connects to the srever.</li>
<li>After new client connection, code is executed again. Server starts to read channels from clientA (port 50632) and prints the data sent some time ago <code>Hello Server from ClientA Again</code></li>
<li>Server is blocked again waiting for clientB sending data&hellip;</li>
</ul>
</li>
</ul>
<h2 id="summary">
  Summary
  <a class="anchor" href="#summary">#</a>
</h2>
<p>As we can see in the demo, blocking mode is low efficient and unable to hanle multiple client connections using one thread. To handle connection and receiving data from multiple clients properly, we have to create a new thread for each connection, which is unrealistic.
In next post, we will discuss unblocking mode and its underlying problems.</p>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>



  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#code-example">Code Example</a></li>
    <li><a href="#demo">Demo</a>
      <ul>
        <li><a href="#start-the-server">Start the server</a></li>
        <li><a href="#start-clienta">Start clientA</a></li>
        <li><a href="#send-data-from-clienta-to-the-server">Send data from clientA to the server</a></li>
        <li><a href="#send-data-again-from-clienta-to-the-server">Send data again from clientA to the server</a></li>
        <li><a href="#clientb-connects-to-the-server">ClientB connects to the server</a></li>
      </ul>
    </li>
    <li><a href="#summary">Summary</a></li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












