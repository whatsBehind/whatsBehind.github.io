<!DOCTYPE html>
<html lang="en-us" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="
  TLS/SSL and HTTPS
  #

TLS (Transport Layer Security) and its predecessor, SSL (Secure Sockets Layer), are integral to HTTPS, which stands for Hypertext Transfer Protocol Secure. HTTPS is the secure version of HTTP, the primary protocol used for transmitting web pages over the internet. This post will introduce the process of TLS handshake, and the TLS version is TLS 1.2

  TLS Handshake
  #

![client-hello](/docs/programming/web/security/tls-handshake/c  `lient-hello.svg)


Client to Server: ClientHello">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="http://localhost:1313/docs/programming/web-fun/ssl-tls/tls-handshake/">
  <meta property="og:site_name" content="What&#39;s Behind">
  <meta property="og:title" content="TLS Handshake">
  <meta property="og:description" content="TLS/SSL and HTTPS # TLS (Transport Layer Security) and its predecessor, SSL (Secure Sockets Layer), are integral to HTTPS, which stands for Hypertext Transfer Protocol Secure. HTTPS is the secure version of HTTP, the primary protocol used for transmitting web pages over the internet. This post will introduce the process of TLS handshake, and the TLS version is TLS 1.2
TLS Handshake # ![client-hello](/docs/programming/web/security/tls-handshake/c `lient-hello.svg)
Client to Server: ClientHello">
  <meta property="og:locale" content="en_us">
  <meta property="og:type" content="article">
    <meta property="article:section" content="docs">
<title>TLS Handshake | What&#39;s Behind</title>
<link rel="icon" href="/favicon.png" >
<link rel="manifest" href="/manifest.json">
<link rel="canonical" href="http://localhost:1313/docs/programming/web-fun/ssl-tls/tls-handshake/">
<link rel="stylesheet" href="/book.min.6c8b9d2a1fc95075ed7da46ca81060b39add8fff6741ac51259f768929281e2c.css" integrity="sha256-bIudKh/JUHXtfaRsqBBgs5rdj/9nQaxRJZ92iSkoHiw=" crossorigin="anonymous">
  <script defer src="/fuse.min.js"></script>
  <script defer src="/en.search.min.1271336fd2a846a34e458aa99ceb51dadb8d03e882ed6b4376126deb2d66a76c.js" integrity="sha256-EnEzb9KoRqNORYqpnOtR2tuNA&#43;iC7WtDdhJt6y1mp2w=" crossorigin="anonymous"></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><span>What&#39;s Behind</span>
  </a>
</h2>


<div class="book-search hidden">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>















  
  <ul>
    
      
        <li>
          
  
  

  
    <span>Programming</span>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-9488811b2da44d814b719a324549338f" class="toggle"  />
    <label for="section-9488811b2da44d814b719a324549338f" class="flex justify-between">
      <a role="button" class="">Project</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/project/online-chat/" class="">Online Chat</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/project/node-js-auth/" class="">Node Js Auth</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-a3774d0b7f222c1fd859911bed9f84c7" class="toggle"  />
    <label for="section-a3774d0b7f222c1fd859911bed9f84c7" class="flex justify-between">
      <a role="button" class="">Backend</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-d89b2e5681262822056a3eec9d0a41e4" class="toggle"  />
    <label for="section-d89b2e5681262822056a3eec9d0a41e4" class="flex justify-between">
      <a role="button" class="">Java</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-3a8a021e398721afe1d6aaefc5a53581" class="toggle"  />
    <label for="section-3a8a021e398721afe1d6aaefc5a53581" class="flex justify-between">
      <a role="button" class="">Net</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/net/tcp-socket/" class="">Tcp Socket</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-30dab7aa6f04e2575ba9575d3f7aa552" class="toggle"  />
    <label for="section-30dab7aa6f04e2575ba9575d3f7aa552" class="flex justify-between">
      <a role="button" class="">Io</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/io/decorator-pattern-in-java-io/" class="">Decorator Pattern in Java IO</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/io/object-input-and-output-stream/" class="">ObjectInputStream and ObjectOutputStream</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/io/stream-reader-bridge-of-byte-and-char/" class="">Stream Reader: Bridge of Byte and Char</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/io/io-stream/" class="">Java IO Stream</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/io/file/" class="">Java File</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-12abf7232ea9d442045b1411b7978a30" class="toggle"  />
    <label for="section-12abf7232ea9d442045b1411b7978a30" class="flex justify-between">
      <a role="button" class="">Thread</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/thread/start-thread/" class="">Start Thread</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/thread/common-methods/" class="">Common Methods</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/thread/thread-lifecycle/" class="">Thread Lifecycle</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/thread/synchornization/" class="">Synchronization</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/thread/thread-safety/" class="">Thread Safety</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/reflection/" class="">Reflection</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-de3ec6a026b81e65f77c5a7c0f2cd777" class="toggle"  />
    <label for="section-de3ec6a026b81e65f77c5a7c0f2cd777" class="flex justify-between">
      <a role="button" class="">Netty</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/netty/event-loop-group/" class="">EventLoop &amp; EventLoopGroup</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/netty/channel/" class="">Channel &amp; ChannelFuture</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/netty/pipeline-handler/" class="">Pipeline &amp; Handler</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-ac19ec90cf736954489e2a5e8571a790" class="toggle"  />
    <label for="section-ac19ec90cf736954489e2a5e8571a790" class="flex justify-between">
      <a role="button" class="">Nio</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/nio/byte-buffer/" class="">Byte Buffer</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/nio/blocking-mode/" class="">Blocking Mode</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/nio/unblocking-mode/" class="">Unblocking Mode</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/nio/selector/" class="">Selector</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/nio/selector-read/" class="">Selector Read</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/nio/io-model-summary/" class="">I/O  Model Summary</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/java/nio/multiple-threads/" class="">Multiple Threads</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-7fca83de470936b8f46c9d214eb96e6f" class="toggle"  />
    <label for="section-7fca83de470936b8f46c9d214eb96e6f" class="flex justify-between">
      <a role="button" class="">API</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/backend/api/restful-get/" class="">RESTful GET</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-967ab9d3eb6864d350e1e9f8d578bfbe" class="toggle"  />
    <label for="section-967ab9d3eb6864d350e1e9f8d578bfbe" class="flex justify-between">
      <a role="button" class="">Programming Core</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-bd6aae65fa2bf2ec8490fdc7c0aeebe5" class="toggle"  />
    <label for="section-bd6aae65fa2bf2ec8490fdc7c0aeebe5" class="flex justify-between">
      <a role="button" class="">Java</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-638baef7394c63505a0124a6ab8929d4" class="toggle"  />
    <label for="section-638baef7394c63505a0124a6ab8929d4" class="flex justify-between">
      <a role="button" class="">Net</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/programming-core/java/net/tcp-socket/" class="">Tcp Socket</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-050a487401c9ade14154296e864be8a2" class="toggle"  />
    <label for="section-050a487401c9ade14154296e864be8a2" class="flex justify-between">
      <a role="button" class="">Io</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/programming-core/java/io/decorator-pattern-in-java-io/" class="">Decorator Pattern in Java IO</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/programming-core/java/io/object-input-and-output-stream/" class="">ObjectInputStream and ObjectOutputStream</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/programming-core/java/io/stream-reader-bridge-of-byte-and-char/" class="">Stream Reader: Bridge of Byte and Char</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/programming-core/java/io/io-stream/" class="">Java IO Stream</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/programming-core/java/io/file/" class="">Java File</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-6660e5a8131bb9bf21390ee36cb603b4" class="toggle"  />
    <label for="section-6660e5a8131bb9bf21390ee36cb603b4" class="flex justify-between">
      <a role="button" class="">Thread</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/programming-core/java/thread/start-thread/" class="">Start Thread</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/programming-core/java/thread/common-methods/" class="">Common Methods</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/programming-core/java/thread/thread-lifecycle/" class="">Thread Lifecycle</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/programming-core/java/thread/synchornization/" class="">Synchronization</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/programming-core/java/thread/thread-safety/" class="">Thread Safety</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/programming-core/java/reflection/" class="">Reflection</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-7e48aea960dd5f2b76bffb00087424f3" class="toggle"  />
    <label for="section-7e48aea960dd5f2b76bffb00087424f3" class="flex justify-between">
      <a role="button" class="">Netty</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/programming-core/java/netty/event-loop-group/" class="">EventLoop &amp; EventLoopGroup</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/programming-core/java/netty/channel/" class="">Channel &amp; ChannelFuture</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/programming-core/java/netty/pipeline-handler/" class="">Pipeline &amp; Handler</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-bdf55a702353035bca92383ae3fb0776" class="toggle"  />
    <label for="section-bdf55a702353035bca92383ae3fb0776" class="flex justify-between">
      <a role="button" class="">Nio</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/programming-core/java/nio/byte-buffer/" class="">Byte Buffer</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/programming-core/java/nio/blocking-mode/" class="">Blocking Mode</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/programming-core/java/nio/unblocking-mode/" class="">Unblocking Mode</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/programming-core/java/nio/selector/" class="">Selector</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/programming-core/java/nio/selector-read/" class="">Selector Read</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/programming-core/java/nio/io-model-summary/" class="">I/O  Model Summary</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/programming-core/java/nio/multiple-threads/" class="">Multiple Threads</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-9091ac3d236d4bd531308b8633d45035" class="toggle"  />
    <label for="section-9091ac3d236d4bd531308b8633d45035" class="flex justify-between">
      <a role="button" class="">Python</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/programming-core/python/executing-a-python-file/" class="">How Is Python File Executed</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/programming-core/python/re/" class="">RegEx</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/programming-core/python/format-string/" class="">format-string</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-15e5b6cfbe135e4220353ad911edbc9a" class="toggle"  />
    <label for="section-15e5b6cfbe135e4220353ad911edbc9a" class="flex justify-between">
      <a role="button" class="">Os</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-128d8751d4236191f55b9181cd918421" class="toggle"  />
    <label for="section-128d8751d4236191f55b9181cd918421" class="flex justify-between">
      <a role="button" class="">Linux</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/os/linux/linux-manual/" class="">Linux Manual</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-a437cea16383409ff4bb050630be8e13" class="toggle"  />
    <label for="section-a437cea16383409ff4bb050630be8e13" class="flex justify-between">
      <a role="button" class="">MAC Os</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-61556e42b41c13f33940b404f66932ed" class="toggle"  />
    <label for="section-61556e42b41c13f33940b404f66932ed" class="flex justify-between">
      <a role="button" class="">Terminal Command</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/os/mac-os/terminal-command/text-processing-and-searching/" class="">Text Processing and Searching</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-e6cb74216e3654f9a5e7b73f35238902" class="toggle" checked />
    <label for="section-e6cb74216e3654f9a5e7b73f35238902" class="flex justify-between">
      <a role="button" class="">Web Fun</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-0d3743e242e26a6f98a0fa89f2846861" class="toggle"  />
    <label for="section-0d3743e242e26a6f98a0fa89f2846861" class="flex justify-between">
      <a role="button" class="">Glossary</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web-fun/glossary/cors/" class="">CORS</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-70d7dcf823c15e345ec843d1a70a21a8" class="toggle"  />
    <label for="section-70d7dcf823c15e345ec843d1a70a21a8" class="flex justify-between">
      <a role="button" class="">Web API</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web-fun/web-api/web-storage-api/" class="">Web Storage Api</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-1a05672023a223c09aa189778405783e" class="toggle"  />
    <label for="section-1a05672023a223c09aa189778405783e" class="flex justify-between">
      <a role="button" class="">HTTP</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web-fun/http/start-http/" class="">Start HTTP</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web-fun/http/http-methods-and-status-codes/" class="">HTTP Methods &amp; Status Codes</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web-fun/http/http-header-part-1/" class="">HTTP Headers Part 1</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web-fun/http/http-header-part-2/" class="">HTTP Headers Part 2: Content-Type &amp; Accept</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web-fun/http/http-header-part-3/" class="">HTTP Headers Part 3: Cache-Control</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web-fun/http/http-header-part-4/" class="">HTTP Headers Part 4: Cache Validation</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web-fun/http/cookie/" class="">Cookie</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-1ca194987eef13e6c3667a7feb0f908f" class="toggle" checked />
    <label for="section-1ca194987eef13e6c3667a7feb0f908f" class="flex justify-between">
      <a role="button" class="">Ssl Tls</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web-fun/ssl-tls/asymmetric-encryption/" class="">Asymmetric Encryption</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web-fun/ssl-tls/session-vs-token/" class="">Session vs Token</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web-fun/ssl-tls/tls-handshake/" class="active">TLS Handshake</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web-fun/ssl-tls/tls-handshake-client-hello/" class="">TLS Handshake: Client Hello</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web-fun/ssl-tls/tls-handshake-server-hello/" class="">TLS Handshake: Server Hello</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web-fun/ssl-tls/tls-handshake-certificate/" class="">TLS Handshake: Certificate</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web-fun/ssl-tls/tls-handshake-certificate-verify/" class="">TLS Handshake: Certificate Verify</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web-fun/ssl-tls/tls-handshake-certificate-finished/" class="">TLS Handshake: Finished</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/web-fun/ssl-tls/simulating-https/" class="">Simulating HTTPS</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-43effcc73883f6032917b714430cd064" class="toggle"  />
    <label for="section-43effcc73883f6032917b714430cd064" class="flex justify-between">
      <a role="button" class="">Tools</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-13ffff656c2dc3dfe4c18658b113a7be" class="toggle"  />
    <label for="section-13ffff656c2dc3dfe4c18658b113a7be" class="flex justify-between">
      <a role="button" class="">Hugo</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/tools/hugo/set-up-hugo-in-git-hub-pages/" class="">Set Up Hugo in Git Hub Pages</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-9cd6328cf5cf698fa6c672c2db6d2035" class="toggle"  />
    <label for="section-9cd6328cf5cf698fa6c672c2db6d2035" class="flex justify-between">
      <a role="button" class="">Cloud</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-7bf71894cadd24d41821eba6f15a9523" class="toggle"  />
    <label for="section-7bf71894cadd24d41821eba6f15a9523" class="flex justify-between">
      <a role="button" class="">Aws</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/cloud/aws/cloudformation/" class="">CloudFormation</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-26749471ddc426a91f4eb4368b916e16" class="toggle"  />
    <label for="section-26749471ddc426a91f4eb4368b916e16" class="flex justify-between">
      <a role="button" class="">Message</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/cloud/aws/message/sns/" class="">SNS</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/cloud/aws/message/sqs/" class="">SQS</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/cloud/aws/message/eventbridge/" class="">EventBridge</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-d92b00c426b17cc8f5bb49854760a2a5" class="toggle"  />
    <label for="section-d92b00c426b17cc8f5bb49854760a2a5" class="flex justify-between">
      <a role="button" class="">Security</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/cloud/aws/security/kms/" class="">KMS</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-6464d2d3fb1a4e9e5d7077427324262c" class="toggle"  />
    <label for="section-6464d2d3fb1a4e9e5d7077427324262c" class="flex justify-between">
      <a role="button" class="">K8s</a>
    </label>
  

          
  <ul>
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-f08994ed3456b39a7f1229df10e15d9f" class="toggle"  />
    <label for="section-f08994ed3456b39a7f1229df10e15d9f" class="flex justify-between">
      <a role="button" class="">Network</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/network/dns/" class="">DNS</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/network/dns-hands-on/" class="">DNS Hands On</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/network/id-address/" class="">IP Address</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/network/cird/" class="">CIRD</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/network/subnet/" class="">Subnet</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-4634b8a2422e3042385f4c14a0822f58" class="toggle"  />
    <label for="section-4634b8a2422e3042385f4c14a0822f58" class="flex justify-between">
      <a role="button" class="">System Design</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-635ac14c32f4b096cb88b04c783b749f" class="toggle"  />
    <label for="section-635ac14c32f4b096cb88b04c783b749f" class="flex justify-between">
      <a role="button" class="">Design Data Intensive Applications</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/system-design/design-data-intensive-applications/replication/" class="">Replication</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/system-design/design-data-intensive-applications/partition/" class="">Partition</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/system-design/design-data-intensive-applications/transactions/" class="">Transactions</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-43f8309f7625d11a21842e4f1759c1f1" class="toggle"  />
    <label for="section-43f8309f7625d11a21842e4f1759c1f1" class="flex justify-between">
      <a role="button" class="">Load Balancing</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/system-design/load-balancing/load-balancer/" class="">Load Balancer</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-2a6004e8987d26d95ed1c07df5a63b81" class="toggle"  />
    <label for="section-2a6004e8987d26d95ed1c07df5a63b81" class="flex justify-between">
      <a role="button" class="">Haproxy</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/system-design/load-balancing/haproxy/get-start/" class="">HAProxy: Get Started</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/system-design/load-balancing/haproxy/health-check/" class="">HAProxy: Health Check</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/system-design/load-balancing/haproxy/load-balancing-algorithm/" class="">HAProxy: Load Balancing Algorithem</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/system-design/load-balancing/haproxy/layer7-load-balancing/" class="">HAProxy: HTTP (Layer 7) Load Balancing</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/system-design/load-balancing/haproxy/http-sticky-sessions-cookies/" class="">HAProxy: Sticky Sessions Using Cookies</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-d6b5a5ebe02e8f45cd65f61120086e8f" class="toggle"  />
    <label for="section-d6b5a5ebe02e8f45cd65f61120086e8f" class="flex justify-between">
      <a role="button" class="">Monitoring</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/system-design/monitoring/metric-log/" class="">Metric &amp; Log</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-5b4a6554295593bd19ab191ce0f0890a" class="toggle"  />
    <label for="section-5b4a6554295593bd19ab191ce0f0890a" class="flex justify-between">
      <a role="button" class="">Technology</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-e65dadec602a3e741624a6eace4b2779" class="toggle"  />
    <label for="section-e65dadec602a3e741624a6eace4b2779" class="flex justify-between">
      <a role="button" class="">Docker</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/system-design/technology/docker/docker-basics/" class="">Docker Basics</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-82f8da13d6fac792702112b64522aa5d" class="toggle"  />
    <label for="section-82f8da13d6fac792702112b64522aa5d" class="flex justify-between">
      <a role="button" class="">Redis</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/system-design/technology/redis/why-is-redis-so-fast/" class="">Why Is Redis So Fast</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/system-design/technology/redis/data-presistence/" class="">Data Persistence</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/system-design/technology/redis/pub-sub/" class="">Redis Pub/Sub</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/programming/system-design/technology/redis/replication-and-sentinel/" class="">Redis Replication &amp; Sentinel</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>














</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <h3>TLS Handshake</h3>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#tlsssl-and-https">TLS/SSL and HTTPS</a></li>
        <li><a href="#tls-handshake">TLS Handshake</a></li>
        <li><a href="#symmetric-encryption-in-tls-handshake">Symmetric Encryption in TLS Handshake</a></li>
        <li><a href="#reference">Reference</a></li>
      </ul>
    </li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown book-article"><h2 id="tlsssl-and-https">
  TLS/SSL and HTTPS
  <a class="anchor" href="#tlsssl-and-https">#</a>
</h2>
<p>TLS (Transport Layer Security) and its predecessor, SSL (Secure Sockets Layer), are integral to HTTPS, which stands for Hypertext Transfer Protocol Secure. HTTPS is the secure version of HTTP, the primary protocol used for transmitting web pages over the internet. This post will introduce the process of TLS handshake, and the TLS version is TLS 1.2</p>
<h2 id="tls-handshake">
  TLS Handshake
  <a class="anchor" href="#tls-handshake">#</a>
</h2>
<p>![client-hello](/docs/programming/web/security/tls-handshake/c  `lient-hello.svg)</p>
<ol>
<li>
<p>Client to Server: ClientHello</p>
<p>The client starts the handshake by sending a <code>ClientHello</code> message. This message includes</p>
<ul>
<li>the TLS version the client supports,</li>
<li>a list of cryptographic algorithms (cipher suites) it can use,</li>
<li>and a random byte string (client random) for key generation purposes.</li>
</ul>
</li>
</ol>
<p><img src="/docs/programming/web/security/tls-handshake/server-hello.svg" alt="server-hello" /></p>
<ol start="2">
<li>Server to Client: ServerHello</li>
</ol>
<p>The server responds with a <code>ServerHello</code> message. This message indicates the chosen TLS protocol version (compatible with the client&rsquo;s version), selects a cipher suite from the client&rsquo;s list, and includes a server-generated random byte string (server random).</p>
<ol start="3">
<li>Server to Client: Certificate</li>
</ol>
<p>The server sends its digital certificate to the client. This certificate, typically issued by a trusted Certificate Authority (CA), contains the server&rsquo;s public key and is used to authenticate the server to the client.</p>
<ol start="4">
<li>Server to Client: Server Key Exchange</li>
</ol>
<p>This message is sent by the server only if the server&rsquo;s digital certificate does not contain enough data to allow the client to exchange a pre-master secret. It provides cryptographic parameters necessary for the client to establish the pre-master secret.</p>
<ol start="5">
<li>Server to Client: Server Hello Done</li>
</ol>
<p>This message indicates the end of the <code>ServerHello</code> and associated messages. After sending this message, the server waits for the client&rsquo;s response.</p>
<p><img src="/docs/programming/web/security/tls-handshake/pre-master-key-exchange.svg" alt="pre-master-key-exchange" /></p>
<ol start="6">
<li>
<p>Client to Server: Client Key Exchange, Change Cipher Spec, Encrypted Handshake Message</p>
<ul>
<li>Client Key Exchange: The client responds with key exchange data, which typically includes a pre-master secret encrypted with the server&rsquo;s public key.</li>
<li>Change Cipher Spec: The client then sends a message indicating that subsequent messages from the client will be encrypted using the newly agreed cipher suite and keys.</li>
<li>Encrypted Handshake Message: This is a &lsquo;Finished&rsquo; message encrypted with the new encryption settings. It provides a cryptographic check that ensures the integrity of the handshake thus far.</li>
</ul>
</li>
</ol>
<p><img src="/docs/programming/web/security/tls-handshake/tls-handshake-whole-process.svg" alt="tls-handshake-whole-process" />
7. Server to Client: Encrypted Handshake Message</p>
<p>The server decrypts the client&rsquo;s &lsquo;Finished&rsquo; message and verifies it. Then, it sends its own &lsquo;Finished&rsquo; message, encrypted with the agreed cipher suite and keys. This message serves to confirm that the server part of the handshake is complete and that the server will begin to use the new security settings for all subsequent messages.</p>
<h2 id="symmetric-encryption-in-tls-handshake">
  Symmetric Encryption in TLS Handshake
  <a class="anchor" href="#symmetric-encryption-in-tls-handshake">#</a>
</h2>
<ul>
<li>Establishing a Session Key:</li>
</ul>
<p>After the asymmetric exchange of the pre-master secret, both the client and the server independently compute the master secret from the pre-master secret and the random numbers exchanged in the <code>ClientHello</code> and <code>ServerHello</code> messages.</p>
<ul>
<li>Generation of Session Keys:</li>
</ul>
<p>From the master secret, both parties derive a set of symmetric session keys using a secure key derivation function. These keys include separate encryption and MAC (Message Authentication Code) keys for both client-to-server and server-to-client communication.</p>
<ul>
<li>Data Encryption:</li>
</ul>
<p>Once the symmetric session keys are established, all subsequent data transmitted during the TLS session is encrypted using symmetric encryption. This includes the final part of the handshake, where both the client and server exchange &lsquo;Finished&rsquo; messages encrypted with the symmetric keys.</p>
<h2 id="reference">
  Reference
  <a class="anchor" href="#reference">#</a>
</h2>
<p><a href="https://www.bilibili.com/video/BV1KY411x7Jp/?spm_id_from=333.337.search-card.all.click&amp;vd_source=8a0ebf984753817eaa0d64cff25fac50">Bilibili Video</a></p>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">





</div>



  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#tlsssl-and-https">TLS/SSL and HTTPS</a></li>
        <li><a href="#tls-handshake">TLS Handshake</a></li>
        <li><a href="#symmetric-encryption-in-tls-handshake">Symmetric Encryption in TLS Handshake</a></li>
        <li><a href="#reference">Reference</a></li>
      </ul>
    </li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












